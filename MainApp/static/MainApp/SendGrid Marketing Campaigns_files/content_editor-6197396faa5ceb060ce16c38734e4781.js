window.Nlvx=window.Nlvx||{},window.Nlvx.Routers=window.Nlvx.Routers||{},window.Nlvx.ContentEditor=window.Nlvx.ContentEditor||{},function(){Nlvx.ContentEditor.ScreenBehaviors={overrideDeleteKey:function(t,e){var n;return n="keydown.dragndropdeletekeyoverride",t?($(document).off(n),$(document).on(n,function(){return function(t){var n;return n=t.keyCode||t.which,8!==n&&46!==n||!e?void 0:e(t)}}(this))):$(document).off(n)}}}.call(this),function(){Nlvx.ContentEditor.EditorViewBase=function(){function t(){}return t.prototype.isInputFocused=function(){var t;return t=$(":focus"),t.is("input")||t.is("textarea")||t.hasClass("cke_editable")},t}()}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor=function(){function n(){this.$moduleDragArea=$("[role='drag-drop-modules-list']"),this.$moduleArea=$("[role='module-area']"),this.$moduleDropArea=$("[role='module-drop-area']"),this.$preHeaderArea=$("[role='pre-header-area']"),this.$footerArea=$("[role='footer-area']"),this.$editingArea=$("[role='module-editing-area']"),this.$toolbar=$("[role='module-editor-toolbar']"),this.dndTemplateActive=!0,this.validModules=Nlvx.DragAndDropEditor.validModules,this.moduleDragtemplate=Handlebars.compile(e),this.finalHTMLTemplate=Handlebars.compile(t),this.styleTab=Nlvx.DragAndDropEditor.styleTab,$("<div/>").ckeditor(Nlvx.DragAndDropEditor.ckConfig),this.setupDropArea(),this.setupDragArea(),Nlvx.ImageLibraryStore.populate(),this.styleTab.init()}var i,o,a,l,s,u;return s=[{name:"Width",type:"NumberInput",unit:"PX",canBeBlank:!0,shouldUpdateOnKeyUp:!1,minimumValue:200,attributeName:"containerwidth"},{name:"Background Color",type:"ColorPicker",attributeName:"containerbackground"},{name:"Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"containerpadding"}],a={containerwidth:600,containerbackground:"#FFFFFF",containerpadding:"0,0,0,0"},o=[{name:"Background Color",type:"ColorPicker",attributeName:"bodybackground"},{name:"Text Color",type:"ColorPicker",attributeName:"bodytextcolor"},{name:"Link Color",type:"ColorPicker",attributeName:"bodylinkcolor"},{name:"",type:"Divider"},{name:"Font Family",type:"Select",attributeName:"bodyfontname",options:[{name:"Helvetica",value:"helvetica,arial,sans-serif"},{name:"Arial",value:"arial,sans-serif"},{name:"Arial Black",value:'"Arial Black",arial,sans-serif'},{name:"Geneva",value:"geneva, arial, sans-serif"},{name:"Lucida Sans Unicode/Grande",value:'"Lucida Sans Unicode", "Lucida Grande", sans-serif'},{name:"Tahoma",value:"tahoma,sans-serif"},{name:"Trebuchet MS",value:"trebuchet ms,sans-serif"},{name:"Verdana",value:"verdana,arial,sans-serif"},{name:"Impact",value:"impact, charcoal, sans-serif"},{name:"Courier",value:"courier, serif"},{name:"Courier New",value:"courier new, serif"},{name:"Lucida Console",value:'"Lucida Console",courier, serif'},{name:"Georgia",value:"georgia, times new roman, serif"},{name:"Palatino",value:"Palatino, georgia, serif"},{name:"Times New Roman",value:"times new roman, serif"},{name:"Comic Sans",value:'"Comic Sans MS", "Marker Felt", sans-serif'}]},{name:"Font Size",type:"NumberInput",unit:"PX",inputs:1,attributeName:"bodyfontsize"}],i={bodybackground:"#FFFFFF",bodytextcolor:"#000000",bodylinkcolor:"#1188e6",bodyfontsize:"14px",bodyfontname:"arial,sans-serif"},u=function(){function t(t,e,n){this.displayName=null!=t?t:"",this.styles=null!=e?e:[],null==n&&(n={}),this.attributes=_.extend({dropped:!0},n),this.$html=$()}return t.prototype.getStyles=function(){return this.styles},t.prototype.isFake=!0,t.prototype.updateAttributes=function(t){return _.extend(this.attributes,t),$(this).trigger("update",{attributes:this.attributes})},t}(),l=function(t){function e(t,n,r){r.tableWidth=r.containerwidth,null!=r.tableWidth&&r.tableWidth>0||(r.tableWidth="100%"),e.__super__.constructor.call(this,t,n,r)}return r(e,t),e.prototype.updateAttributes=function(t){return t.tableWidth=t.containerwidth,null!=t.tableWidth&&t.tableWidth>0||(t.tableWidth="100%"),e.__super__.updateAttributes.call(this,t)},e}(u),n.prototype.onContainerSettingsUpdate=function(t,e){var n,r,i,o,a;return this.resetContainerStyles(),n=e.attributes,null!=n&&(a=n.containerwidth,r=n.containerbackground,i=n.containerpadding,null!=a&&this.$editingArea.width(a),null!=r&&this.$editingArea.css("background-color",r),null!=i&&(o=i.split(",").join("px ").concat("px"),this.$editingArea.css("padding",o))),$(this).trigger("change")},n.prototype.resetContainerStyles=function(){return this.$editingArea.css({width:"",backgroundColor:"",padding:""})},n.prototype.onBodySettingsUpdate=function(t,e){var n,r,i,o,a,l;return this.resetBodyStyles(),n=e.attributes,null!=n&&(r=n.bodybackground,i=n.bodyfontname,o=n.bodyfontsize,l=n.bodytextcolor,a=n.bodylinkcolor,null!=r&&r.length&&this.$moduleArea.css("background-color",r),null!=i&&i.length&&this.$moduleArea.css("font-family",i),null!=o&&this.$moduleArea.css("font-size",""+o+"px"),null!=l&&l.length&&this.$moduleArea.css("color",l),null!=a&&a.length&&(this.$style=$("<style>#module-editing-area a { color: "+a+"; }</style>"),this.$style.appendTo("body"))),$(this).trigger("change")},n.prototype.resetBodyStyles=function(){var t;return null!=(t=this.$style)&&t.remove(),this.$moduleArea.css({backgroundColor:"",fontFamily:"",fontSize:"",color:""})},n.prototype.redraw=function(){return this.dndTemplateActive=!0,this.teardownModules(),this.drawModules(),this.$toolbar.find(".cke:first-child").show()},n.prototype.deactivate=function(){return this.dndTemplateActive=!1},n.prototype.teardownModules=function(){var t,e,n,r,i;for(this.contractDropArea(),this.resetBodyStyles(),this.resetContainerStyles(),r=this.getAllModules(),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.teardown());return i},n.prototype.drawModules=function(){var t,e,n,r,i,o;for(this.html=Nlvx.ContentEditor.contentCollection.getHTML(),this.parser=new Nlvx.DragAndDropEditor.Parser(this.html),this.createContainerModule(),this.createBodyModule(),n=this.parser.getModules(),r=_.find(n,function(t){return"preheader"===t.getType()}),r?n=_.reject(n,function(t){return"preheader"===t.getType()}):r=new Nlvx.DragAndDropEditor.modules.preheader,_.find(n,function(t){return"footer"===t.getType()})||n.push(new Nlvx.DragAndDropEditor.modules.footer),i=0,o=n.length;o>i;i++)e=n[i],t=e.build(this.$moduleDropArea),"footer"===e.getType()?this.$footerArea.append(t):this.$moduleDropArea.append(t),e.afterBuild(),this.bindModuleEvents(e);return r.build(),r.afterBuild(),this.bindModuleEvents(r),this.renderStyleTab(n)},n.prototype.createContainerModule=function(){var t,e;return e=this.parser.getContainerAttributes(),t=_.extend({},a,e),this.fakeContainerModule=new l("Content Container",s,t),$(this.fakeContainerModule).on("update",_.bind(this.onContainerSettingsUpdate,this)),this.onContainerSettingsUpdate($.Event(),{attributes:this.fakeContainerModule.attributes})},n.prototype.createBodyModule=function(){var t,e;return e=this.parser.getBodyAttributes(),t=_.extend({},i,e),this.fakeBodyModule=new u("Email Body",o,t),$(this.fakeBodyModule).on("update",_.bind(this.onBodySettingsUpdate,this)),this.onBodySettingsUpdate($.Event(),{attributes:this.fakeBodyModule.attributes})},n.prototype.duplicateModule=function(t){var e,n,r,i,o,a,l;return r=t.getHTML(),o=new Nlvx.DragAndDropEditor.Parser(r),i=o.getModules(),n=i[0],e=n.build(t.$parent),t.$html.after(e),n.afterBuild(),n.attributes.dropped=!0,this.$moduleDropArea.sortable("refresh"),this.bindModuleEvents(n),this.renderStyleTab(),null!=(l=n.styleGroup)&&l.openAccordion(),a=n.$html.position().top,null!=a&&this.$moduleArea.animate({scrollTop:a},400),$(this).trigger("change")},n.prototype.bindModuleEvents=function(t){return $(t).off("change remove duplicate renderstyletab renderstyletabandopen"),$(t).on({duplicate:function(e){return function(){return e.duplicateModule(t)}}(this),change:function(t){return function(){return $(t).trigger("change")}}(this),renderstyletab:function(t){return function(){return t.renderStyleTab()}}(this),renderstyletabandopen:function(e){return function(){var n;return e.renderStyleTab(),null!=(n=t.styleGroup)?n.openAccordion(!0):void 0}}(this)})},n.prototype.getModulesHTML=function(){var t,e,n,r,i;return e=this.fakeContainerModule.attributes,t=this.fakeBodyModule.attributes,r=this.getAllModules(),i=new Nlvx.DragAndDropEditor.modules.preheader,r.unshift(i),n=_.map(r,function(t){return t.getHTML()}).join(""),this.finalHTMLTemplate({html:n,active:this.dndTemplateActive,containerSettings:e,bodySettings:t})},n.prototype.setupDragArea=function(){return this.addDragModules(),this.$moduleDragArea.find("li").draggable({connectToSortable:this.$moduleDropArea,helper:"clone",start:_.bind(this.expandDropArea,this),stop:_.bind(this.contractDropArea,this)})},n.prototype.addDragModules=function(){var t,e,n,r,i,o;for(i=this.validModules,o=[],n=0,r=i.length;r>n;n++)e=i[n],e.draggable?(t=$(this.moduleDragtemplate(e)),o.push(this.$moduleDragArea.append(t))):o.push(void 0);return o},n.prototype.setupDropArea=function(){return this.$moduleDropArea.sortable({placeholder:"module-placeholder",handle:".module-controls__move",tolerance:"intersect",items:"> [role='module']",receive:_.bind(this.onDrop,this),stop:_.bind(this.onSortStop,this),start:_.bind(this.onSortStart,this),connectWith:".column-drop-area",helper:function(t,e){var n,r,i,o;return r=e.clone(),n=e.find(".module-controls").clone(),i=$("<div class='sorting-helper-overflow'></div>"),o=$("<div class='sorting-helper'/>"),i.append(r),o.append(i,n),o}})},n.prototype.removeSelectedModules=function(){var t,e,n,r,i;for(r=this.getAllModules(),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.isSelected()?t.removeModule():void 0);return i},n.prototype.onSortStart=function(){return this.$moduleDropArea.addClass("sorting"),this.expandDropArea()},n.prototype.expandDropArea=function(){var t,e,n,r,i,o;return this.$moduleDropArea.addClass("expanded"),o=this.$moduleArea.outerHeight(),i=this.$toolbar.outerHeight(),r=this.$preHeaderArea.outerHeight(),n=this.$footerArea.outerHeight(),e=this.$moduleDropArea.outerHeight(),t=o-i-r-n,t>e?(this.$moduleDropArea.height(t),this.$moduleDropArea.sortable("refresh")):void 0},n.prototype.contractDropArea=function(){return this.$moduleDropArea.removeClass("expanded"),this.$moduleDropArea.height("auto")},n.prototype.isFromDraggable=function(t){return null!=t.item&&$(t.item).is("[role='drag-drop-module']")},n.prototype.isFromChildSortable=function(t){return null!=t.sender&&$(t.sender).is("[role*='column-']")},n.prototype.isChildSortable=function(t){return null!=t.item&&$(t.item).parent().is("[role*='column-']")},n.prototype.getTypeFromDraggable=function(t){return null!=t.item?$(t.item).data("type"):void 0},n.prototype.getAllModules=function(){var t;return t=this.$preHeaderArea.find("> [role='module']").add(this.$moduleDropArea.find("> [role='module']").add(this.$footerArea.find("> [role='module']"))),_.map(t,function(t){return $(t).data("module")})},n.prototype.onSortStop=function(t,e){var n,r,i,o,a;return o=this.getTypeFromDraggable(e),r=$(e.item),this.isFromDraggable(e)&&this.isValidModuleType(o)?(i=new Nlvx.DragAndDropEditor.modules[o],window.analytics.track("dd_editor",{module_name:i.displayName}),n=i.build(r.parent()),r.replaceWith(n),i.afterBuild(),i.attributes.dropped=!0,this.bindModuleEvents(i),this.$moduleDropArea.sortable("refresh")):i=r.data("module"),this.isFromChildSortable(e)||this.isChildSortable(e)||(this.renderStyleTab(),null!=(a=i.styleGroup)&&a.openAccordion(!this.isFromDraggable(e))),e.helper&&$(e.helper).remove(),this.contractDropArea(),this.$moduleDropArea.removeClass("sorting"),$(this).trigger("change")},n.prototype.isValidModuleType=function(t){var e;return e=_.pluck(this.validModules,"type"),_.contains(e,t)},n.prototype.onDrop=function(t,e){var n,r;return this.isFromChildSortable(e)?(n=$(e.item).data("module"),this.bindModuleEvents(n),this.renderStyleTab(),null!=(r=n.styleGroup)?r.openChildModule(n):void 0):void 0},n.prototype.renderStyleTab=function(t){var e;return null==t&&(t=this.getAllModules()),e={global:[this.fakeBodyModule,this.fakeContainerModule],modules:t},this.styleTab.render(e)},n}(),e='<li class="drag-module drag-module--{{type}}" data-type="{{type}}" role="drag-drop-module">\n  <p class="module-caption">{{displayName}}</p>\n</li>',t='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">\n<html xmlns="http://www.w3.org/1999/xhtml" {{#if active}}data-dnd="true"{{/if}}>\n<head>\n  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />\n  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />\n  <!--[if !mso]><!-->\n  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n  <!--<![endif]-->\n\n  <!--[if (gte mso 9)|(IE)]><style type="text/css">\n  table {border-collapse: collapse;}\n  table, td {mso-table-lspace: 0pt;mso-table-rspace: 0pt;}\n  img {-ms-interpolation-mode: bicubic;}\n  </style>\n  <![endif]-->\n  <style type="text/css">\n  body {\n    color: {{bodySettings.bodytextcolor}};\n  }\n  body a {\n    color: {{bodySettings.bodylinkcolor}};\n    text-decoration: none;\n  }\n  p { margin: 0; padding: 0; }\n  table[class="wrapper"] {\n    width:100% !important;\n    table-layout: fixed;\n    -webkit-font-smoothing: antialiased;\n    -webkit-text-size-adjust: 100%;\n    -moz-text-size-adjust: 100%;\n    -ms-text-size-adjust: 100%;\n  }\n  img[class="max-width"] {\n    max-width: 100% !important;\n  }\n  @media screen and (max-width:480px) {\n    .preheader .rightColumnContent,\n    .footer .rightColumnContent {\n        text-align: left !important;\n    }\n    .preheader .rightColumnContent div,\n    .preheader .rightColumnContent span,\n    .footer .rightColumnContent div,\n    .footer .rightColumnContent span {\n      text-align: left !important;\n    }\n    .preheader .rightColumnContent,\n    .preheader .leftColumnContent {\n      font-size: 80% !important;\n      padding: 5px 0;\n    }\n    table[class="wrapper-mobile"] {\n      width: 100% !important;\n      table-layout: fixed;\n    }\n    img[class="max-width"] {\n      height: auto !important;\n    }\n    a[class="bulletproof-button"] {\n      display: block !important;\n      width: auto !important;\n      font-size: 80%;\n      padding-left: 0 !important;\n      padding-right: 0 !important;\n    }\n    // 2 columns\n    #templateColumns{\n        width:100% !important;\n    }\n\n    .templateColumnContainer{\n        display:block !important;\n        width:100% !important;\n        padding-left: 0 !important;\n        padding-right: 0 !important;\n    }\n  }\n  </style>\n  {{bodyfontname bodySettings}}\n  {{bodyfontsize bodySettings}}\n</head>\n<body yahoofix="true" style="min-width: 100%; margin: 0; padding: 0; font-size: {{bodySettings.bodyfontsize}}px; font-family: {{bodySettings.bodyfontname}}; color: {{bodySettings.bodytextcolor}}; background-color: {{bodySettings.bodybackground}}; color: {{bodySettings.bodytextcolor}};" data-attributes=\'{{bodysaveattributes bodySettings}}\'>\n  <center class="wrapper">\n    <div class="webkit">\n      <table cellpadding="0" cellspacing="0" border="0" width="100%" class="wrapper" bgcolor="{{bodySettings.bodybackground}}">\n      <tr><td valign="top" bgcolor="{{bodySettings.bodybackground}}" width="100%">\n      <!--[if (gte mso 9)|(IE)]>\n      <table width="{{containerSettings.tableWidth}}" align="center" cellpadding="0" cellspacing="0" border="0">\n        <tr>\n          <td>\n          <![endif]-->\n            <table width="100%" role="content-container" class="outer" data-attributes=\'{{containersaveattributes containerSettings}}\' align="center" cellpadding="0" cellspacing="0" border="0">\n              <tr>\n                <td width="100%"><table width="100%" cellpadding="0" cellspacing="0" border="0">\n                  <tr>\n                    <td>\n                    <!--[if (gte mso 9)|(IE)]>\n                      <table width="{{containerSettings.tableWidth}}" align="center" cellpadding="0" cellspacing="0" border="0">\n                        <tr>\n                          <td>\n                            <![endif]-->\n                              <table width="100%" cellpadding="0" cellspacing="0" border="0" style="width: 100%; max-width:{{maxwidth containerSettings.tableWidth}};" align="center">\n                                <tr><td role="modules-container" style="{{containerpadding containerSettings}} color: {{bodySettings.bodytextcolor}}; text-align: left;" bgcolor="{{containerSettings.containerbackground}}" width="100%" align="left">\n                                  {{{html}}}\n                                </tr></td>\n                              </table>\n                            <!--[if (gte mso 9)|(IE)]>\n                          </td>\n                        </td>\n                      </table>\n                    <![endif]-->\n                    </td>\n                  </tr>\n                </table></td>\n              </tr>\n            </table>\n          <!--[if (gte mso 9)|(IE)]>\n          </td>\n        </tr>\n      </table>\n      <![endif]-->\n      </tr></td>\n      </table>\n    </div>\n  </center>\n</body>\n</html>',Handlebars.registerHelper("maxwidth",function(t){var e;return e=/%/.test(t)?t:""+t+"px",new Handlebars.SafeString(e)}),Handlebars.registerHelper("containersaveattributes",function(t){var e,n;return e={dropped:!0,containerpadding:t.containerpadding,containerwidth:t.containerwidth,containerbackground:t.containerbackground},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("containerpadding",function(t){var e;return e=t.containerpadding||"",0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")}),Handlebars.registerHelper("bodysaveattributes",function(t){var e,n;return e={dropped:!0,bodybackground:t.bodybackground,bodyfontname:t.bodyfontname,bodytextcolor:t.bodytextcolor,bodylinkcolor:t.bodylinkcolor,bodyfontsize:t.bodyfontsize},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("bodyfontname",function(t){var e;return e=null!=t.bodyfontname&&t.bodyfontname.length?"<style>\n  body, p, div { font-family: "+t.bodyfontname+"; }\n</style>":"",new Handlebars.SafeString(e)}),Handlebars.registerHelper("bodyfontsize",function(t){var e;return e=null!=t.bodyfontsize&&t.bodyfontsize>0?"<style>\n  body, p, div { font-size: "+t.bodyfontsize+"px; }\n</style>":"",new Handlebars.SafeString(e)}),Nlvx.DragAndDropEditor.validModules=[{type:"image",displayName:"Image",draggable:!0},{type:"imagetext",displayName:"Image & Text",draggable:!0},{type:"text",displayName:"Text",draggable:!0},{type:"wysiwyg",displayName:"Wysiwyg",draggable:!0},{type:"button",displayName:"Button",draggable:!0},{type:"spacer",displayName:"Space",draggable:!0},{type:"divider",displayName:"Divider",draggable:!0},{type:"columns",displayName:"Columns",draggable:!0},{type:"preheader",displayName:"Pre-Header",draggable:!1},{type:"footer",displayName:"Footer",draggable:!1},{type:"social",displayName:"Social",draggable:!0}],Nlvx.DragAndDropEditor.ckConfig={startupFocus:!0,title:!1,sharedSpaces:{top:"module-editor__toolbar"},toolbar:[{name:"colors",items:["TextColor","BGColor"]},{name:"styles",items:["Format","Font","FontSize"]},{name:"basic styles",items:["Bold","Italic","Underline","RemoveFormat"]},{name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight"]},{name:"lists",items:["NumberedList","BulletedList"]},{name:"misc",items:["Table","Imagelibrary","Sglink","HorizontalRule"]}]}}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Nlvx.DragAndDropEditor.ColumnsEditor=function(){function e(e,n,r){var i,o;this.$moduleDropArea=e,this.innerHTML=null!=n?n:"",this.columnModule=r,this.onModuleRenderStyleTabAndOpen=t(this.onModuleRenderStyleTabAndOpen,this),this.onModuleRemove=t(this.onModuleRemove,this),this.onModuleChange=t(this.onModuleChange,this),this.$moduleDragArea=$("[role='drag-drop-modules-list']"),this.$moduleParentDropArea=$("[role='module-drop-area']"),i=["columns","imagetext"],this.validModules=_.reject(Nlvx.DragAndDropEditor.validModules,function(t){return _.contains(i,t.type)}),this.styleTab=Nlvx.DragAndDropEditor.styleTab,this.setupDropArea(),this.setupDragArea(),(null!=(o=this.innerHTML)?o.length:void 0)&&this.drawModules()}return e.prototype.deactivate=function(){},e.prototype.drawModules=function(){var t,e,n,r,i;for(this.parser=new Nlvx.DragAndDropEditor.Parser(this.innerHTML),n=this.parser.getModules(),r=0,i=n.length;i>r;r++)e=n[r],t=e.build(this.$moduleDropArea),this.$moduleDropArea.append(t),e.afterBuild(),this.bindModuleEvents(e);return this.renderStyleTab(),this.setEmptyIfEmpty()},e.prototype.onModuleChange=function(){return $(this).trigger("change")},e.prototype.onModuleRemove=function(){return this.setEmptyIfEmpty(),$(this).trigger("removeChild")},e.prototype.onModuleRenderStyleTabAndOpen=function(){return $(this).trigger("renderstyletabandopen")},e.prototype.duplicateModule=function(t){var e,n,r,i,o,a;return r=t.getHTML(),o=new Nlvx.DragAndDropEditor.Parser(r),i=o.getModules(),n=i[0],e=n.build(t.$parent),t.$html.after(e),n.afterBuild(),n.attributes.dropped=!0,this.bindModuleEvents(n),this.$moduleDropArea.sortable("refresh"),this.renderStyleTab(),null!=(a=this.columnModule.styleGroup)&&a.openChildModule(n),this.$moduleParentDropArea.removeClass("expanded"),this.$moduleDropArea.removeClass("sorting"),$(this).trigger("change")},e.prototype.bindModuleEvents=function(t){return $(t).off("change remove renderstyletabandopen duplicate"),$(t).on({change:this.onModuleChange,remove:function(e){return function(){return e.onModuleRemove(t)}}(this),renderstyletabandopen:this.onModuleRenderStyleTabAndOpen,duplicate:function(e){return function(){return e.duplicateModule(t)}}(this)})},e.prototype.setupDragArea=function(){return this.$moduleDragArea.find("li").draggable("option","connectToSortable","[role='module-drop-area'],.column-drop-area")},e.prototype.setupDropArea=function(){return this.$moduleDropArea.sortable({placeholder:"module-placeholder",handle:".module-controls__move",tolerance:"pointer",items:"> [role='module']",receive:_.bind(this.onDrop,this),stop:_.bind(this.onSortStop,this),start:_.bind(this.onSortStart,this),connectWith:".column-drop-area,#module-drop-area",helper:function(t,e){var n,r,i;return n=e.clone(),r=$("<div class='sorting-helper-overflow'></div>"),i=$("<div class='sorting-helper'/>"),r.append(n),i.append(r),i}})},e.prototype.onSortStart=function(t,e){return e.item.is("[role='drag-drop-module']")?void 0:(this.$moduleDropArea.addClass("sorting"),this.$moduleParentDropArea.addClass("expanded"))},e.prototype.isFromDraggable=function(t){return null!=t.item&&$(t.item).is("[role='drag-drop-module']")},e.prototype.isFromChildSortable=function(t){return null!=t.sender&&$(t.sender).is("[role*='column-']")},e.prototype.isLeavingChildSortable=function(t){var e,n;return e=this.$moduleDropArea.closest("[role='module']"),null!=t.item&&(n=$(t.item).closest("[data-type='columns']")),!e.is(n)&&!this.isFromDraggable(t)},e.prototype.isFromParentSortable=function(t){return null!=t.sender&&$(t.sender).is("[role='module-drop-area']")},e.prototype.getTypeFromDraggable=function(t){return null!=t.item?$(t.item).data("type"):void 0},e.prototype.onSortStop=function(t,e){var n,r,i,o,a;return o=this.getTypeFromDraggable(e),r=$(e.item),i=null,this.isFromDraggable(e)&&this.isValidModuleType(o)?(i=new Nlvx.DragAndDropEditor.modules[o],n=i.build(r.parent()),r.replaceWith(n),i.afterBuild(),i.attributes.dropped=!0,this.bindModuleEvents(i),this.$moduleDropArea.sortable("refresh")):this.isFromDraggable(e)||(i=r.data("module")),null!=i?(this.isLeavingChildSortable(e)||(this.renderStyleTab(),null!=(a=this.columnModule.styleGroup)&&a.openChildModule(i,!this.isFromDraggable(e))),this.setEmptyIfEmpty(),e.helper&&$(e.helper).remove(),this.$moduleParentDropArea.removeClass("expanded"),this.$moduleDropArea.removeClass("sorting"),$(this).trigger("change")):$(e.item).remove()},e.prototype.isValidModuleType=function(t){var e;return e=_.pluck(this.validModules,"type"),_.contains(e,t)},e.prototype.setEmptyIfEmpty=function(){return this.$moduleDropArea.find("> [role='module']").length?this.$moduleDropArea.removeClass("empty"):this.$moduleDropArea.addClass("empty")},e.prototype.onDrop=function(t,e){var n,r;return(this.isFromParentSortable(e)||this.isFromChildSortable(e))&&(n=$(e.item).data("module"),this.bindModuleEvents(n),this.renderStyleTab(),null!=(r=this.columnModule.styleGroup)&&r.openChildModule(n),$(this).trigger("change")),this.setEmptyIfEmpty()},e.prototype.renderStyleTab=function(){return $(this).trigger("renderstyletab")},e}()}.call(this),function(){Nlvx.DragAndDropEditor.Parser=function(){function t(t){this.html=null!=t?t:"",this.validModules=Nlvx.DragAndDropEditor.validModules}return t.prototype.getModules=function(){return this.parseHTMLToModules()},t.prototype.getChildModules=function(){return this.parseHTMLToModules(!0)},t.prototype.parseHTMLToModules=function(t){var e,n,r,i,o,a,l,s,u,d,c,p,h,g;for(e=this.getHTMLBody(),o=e.find("[role='modules-container']"),n=t?e.find("[role='module']"):o.length?o.find("> *"):e.find("> *"),n.length<1&&(null!=(g=e.html())?g.length:void 0)&&(n=$("<div>"+e.html()+"</div>")),d=[],u=[],p=0,h=n.length;h>p;p++)l=n[p],r=$(l),this.isModule(r)?(d.length&&(u.push(this.createDefaultModuleFromGroup(d)),d=[]),c=r.data("type"),i=r.find("[role='module-content']"),s=i.html(),a=this.getAttributes(r),"preheader"===c?this.handleLegacyPreheader(s,a,u):u.push(this.createModule(c,s,a))):d.push(r.get(0));return d.length&&(u.push(this.createDefaultModuleFromGroup(d)),d=[]),u},t.prototype.handleLegacyPreheader=function(t,e,n){var r,i,o,a,l,s,u,d,c;return o=$(t),r=o.find("[role='column-one']"),i=o.find("[role='column-two']"),r.length?(c=$.trim(r.text()),n.push(new Nlvx.DragAndDropEditor.modules.preheader(c,_.extend(e,{dropped:!0}))),i.length?(l=i.find("[role='module']"),d="text",a=l.find("[role='module-content']"),u=a.html(),s=this.getAttributes(l),n.push(this.createModule(d,u,s))):void 0):(c=o.text(),n.push(new Nlvx.DragAndDropEditor.modules.preheader(c,_.extend(e,{dropped:!0}))))},t.prototype.createDefaultModuleFromGroup=function(t){var e;return e=$(t).wrapAll("<div/>").parent().html(),this.createModule("wysiwyg",e,{})},t.prototype.getAttributes=function(t){var e,n;try{e=JSON.parse(unescape(t.data("attributes")))}catch(r){n=r,e={}}return e},t.prototype.getContainerAttributes=function(){var t,e,n,r;t=this.getHTMLBody(),e=t.find("[role='content-container']");try{n=JSON.parse(unescape(e.data("attributes")))}catch(i){r=i,n={}}return n},t.prototype.getBodyAttributes=function(){var t,e,n;t=this.getHTMLBody();try{e=JSON.parse(unescape(t.data("attributes")))}catch(r){n=r,e={}}return e},t.prototype.createModule=function(t,e,n){return null==e&&(e=""),null==n&&(n={}),t&&this.isValidType(t)?new Nlvx.DragAndDropEditor.modules[t](e,_.extend(n,{dropped:!0})):void 0},t.prototype.isModule=function(t){return"module"===t.attr("role")&&this.isValidType(t.data("type"))},t.prototype.isValidType=function(t){var e;return e=_.pluck(this.validModules,"type"),_.contains(e,t)},t.prototype.getHTMLBody=function(){var t,e;return e=$("<iframe/>"),$("body").append(e),e.get(0).contentDocument.write(this.html),t=e.contents().find("body").clone(),t.length||(t=e.contents().find("html")),e.remove(),t},t}()}.call(this),function(){Nlvx.DragAndDropEditor.styleTab=function(){function t(){}var e,n,r;return r=null,t.init=function(){return r||(r=new e)},t.render=function(t){return null==t&&(t=[]),r.render(t)},e=function(){function t(){this.openGroup=null,this.openChildGroup=null,this.$modulesPanel=$("[role='drag-modules-panel']"),this.$globalStylesPanel=$("[role='global-styles-panel']"),this.$moduleStylesPanel=$("[role='modules-styles-panel']"),this.$moduleStylesPH=$("[role='module-style-placeholder']"),this.modulesCollapsible=n(this.$modulesPanel.find("> h4"),this.$modulesPanel.find("> .collapsible")),this.globalStylesCollapsible=n(this.$globalStylesPanel.find("> h4"),this.$globalStylesPanel.find("> .collapsible")),this.moduleStylesCollapsible=n(this.$moduleStylesPanel.find("> h4"),this.$moduleStylesPanel.find("> .collapsible")),$(this.moduleStylesCollapsible).on("collapsible:beforeclose",function(t){return function(){return t.close()}}(this)),$("[role='module-editing-area']").on("click",function(t){return t.stopPropagation()}),$("[role='module-area']").on("click",function(t){return function(){return t.openGroup?t.close():void 0}}(this))}return t.prototype.render=function(t){var e,n,r,i,o,a,l,s,u,d;for(this.startTop=$(".tab-content").scrollTop(),i=t.global,a=t.modules,e=$("[role='global-style-groups']"),e.empty(),l=0,u=i.length;u>l;l++)r=i[l],this.renderModule(r,e,!0);for(n=$("[role='module-style-groups']"),n.empty(),s=0,d=a.length;d>s;s++)o=a[s],this.renderModule(o,n);return this.modulesCollapsible.open(!1)},t.prototype.maybeOpenChild=function(t,e){return null==e&&(e=!0),null!=t?e?window.setTimeout(function(e){return function(){return e.openChild(t)}}(this),300):this.openChild(t):(this.closeChildren(),this.openChildGroup=null)},t.prototype.bindStyleGroupEvents=function(t){return $(t).on("open",function(e){return function(n,r){var i,o,a,l;return null==r&&(r={}),i=r.withoutAnimation||!0,a=!0,(null!=(l=e.openGroup)?l.module:void 0)===t.module?i=!1:e._close(),null!=r.child&&(o=r.child,a=!1),e.$moduleStylesPH.slideUp({duration:300,easing:"linear"}),e.open(t,i,a,null!=r.child),e.maybeOpenChild(r.child,i)}}(this)),$(t).on("close",function(t){return function(){return t.close()}}(this)),$(t).on("updated:parent",function(e){return function(){return e.openChildGroup=null,e.closeChildren(),t.module.isFake!==!0?e.highlightModule(t.module):void 0}}(this)),$(t).on("updated:child",function(t){return function(e,n){var r;return null==n&&(n={}),r=n.child,null!=r?t.highlightModule(r):void 0}}(this)),$(t).on("removed:child",function(e){return function(n,r){var i,o;return null==r&&(r={}),i=r.child,o=r.parent,t.module===e.openGroup.module&&i===e.openChildGroup?e.closeChildren():void 0}}(this)),$(t).on("removed:parent",function(t){return function(e,n){var r,i;return null==n&&(n={}),r=n.parent,r===(null!=(i=t.openGroup)?i.module:void 0)?t.close():void 0}}(this))},t.prototype.createStyleGroupCollapsible=function(t,e){var n,r,i;return r=t.$html.find("> h4"),n=t.$html.find("> [role='style-attributes']"),i=new Collapsible(r,n),$(i).on("collapsible:beforeopen",function(){return e.find("[role='style-group'] > h4.open").trigger("click")})},t.prototype.renderModule=function(t,e,n){var r;return null==n&&(n=!1),r=new Nlvx.DragAndDropEditor.StyleGroup(t),t.styleGroup=r,this.bindStyleGroupEvents(r),e.append(r.build()),r.afterBuild(),n&&this.createStyleGroupCollapsible(r,e),t.attributes.dropped!==!0?r.openAccordion():void 0},t.prototype.closeChildren=function(){return $("[role='style-children-attributes'] > .module-style-group:visible").slideUp({duration:300,easing:"linear"})},t.prototype.scrollToChild=function(t){var e,n,r,i,o;return r=null!=(o=t.styleGroup)?o.parent:void 0,null!=r?(e=r.$html.find("> h4"),n=r.$html.find("[role='style-attributes']"),i=this.$moduleStylesPanel.find("> h4").outerHeight()+e.outerHeight()+n.outerHeight()+this.$globalStylesPanel.outerHeight()+this.$modulesPanel.outerHeight(),$(".tab-content").animate({scrollTop:i},400)):void 0},t.prototype.openChild=function(t,e){return null==e&&(e=300),t===this.openChildGroup?(t.styleGroup.$html.show(),this.startTop&&$(".tab-content").scrollTop(this.startTop),this.startTop=null):(this.closeChildren(),t.styleGroup.$html.slideDown({duration:e,easing:"linear",complete:function(e){return function(){return e.scrollToChild(t)}}(this)})),this.highlightModule(t),this.openChildGroup=t},t.prototype.open=function(t,e,n,r){return null==e&&(e=!0),null==n&&(n=!0),null==r&&(r=!1),$("a[href='#campaign-build']").trigger("click"),this.moduleStylesCollapsible.open(!0),n&&this.highlightModule(t.module),e?(this.startTop&&$(".tab-content").scrollTop(this.startTop),this.startTop=null,$(t.$html).slideDown({duration:300,easing:"linear",complete:function(t){return function(){var e;return e=t.$moduleStylesPanel.find("> h4").outerHeight()+t.$globalStylesPanel.outerHeight()+t.$modulesPanel.outerHeight(),$(".tab-content").animate({scrollTop:e},400)}}(this)})):($(t.$html).show(),r||(this.startTop&&$(".tab-content").scrollTop(this.startTop),this.closeChildren(),this.startTop=null)),this.openGroup=t},t.prototype.close=function(){return $(".style-group-selected[role='module']").removeClass("style-group-selected"),this._close(),this.$moduleStylesPH.slideDown({duration:300,easing:"linear"}),this.openGroup=null
},t.prototype._close=function(){return null!=this.openGroup&&(this.removeHighlightModule(this.openGroup.module),$(this.openGroup.$html).slideUp({duration:300,easing:"linear"})),this.closeChildren()},t.prototype.highlightModule=function(t){return $(".style-group-selected[role='module']").removeClass("style-group-selected"),$(t.$html).addClass("style-group-selected")},t.prototype.removeHighlightModule=function(t){return $(t.$html).removeClass("style-group-selected")},t}(),n=function(t,e){var n;return n=new Collapsible(t,e),t.data("collapsible",n),n},t}()}.call(this),function(){var t;Nlvx.DragAndDropEditor.StyleGroup=function(){function e(e){this.module=e,this.styles=this.module.getStyles(),this.styleModules=this.createStyleModules(),this.attributes=this.module.attributes,this.template=Handlebars.compile(t)}return e.prototype.build=function(){return this.$html=$(this.template(this.module))},e.prototype.afterBuild=function(){var t,e,n,r,i;for(t=this.$html.find("[role='style-attributes']"),i=this.styleModules,n=0,r=i.length;r>n;n++)e=i[n],this.addStyleModule(e,t);return this.bindEvents(),this.buildChildModules()},e.prototype.bindEvents=function(){return $(this.module).off("select"),$(this.module).on("select",function(t){return function(){return t.openAccordion()}}(this)),$(this.module).off("remove:stylegroup"),$(this.module).on("remove:stylegroup",function(t){return function(){return $(t).trigger("removed:parent",{parent:t.module})}}(this))},e.prototype.buildChildModules=function(){var t;return this.module.hasChildren?(this.$childStyleArea=this.$html.find("[role='style-children-attributes']"),this.$childStyleArea.empty(),t=this.module.getChildModules(),_.each(t,function(t){return function(e){var n;return n=new Nlvx.DragAndDropEditor.StyleGroup.ChildGroup(e,t),e.styleGroup=n,t.$childStyleArea.append(n.build()),n.afterBuild(),$(e).off("select"),$(e).on("select",function(){return t.openChildModule(e)}),$(n).on("update",function(){return $(t).trigger("updated:child",{child:e})}),$(n).on("remove",function(){return $(t).trigger("removed:child",{child:e,parent:t.module})})}}(this))):void 0},e.prototype.addStyleModule=function(t,e){return e.append(t.build()),t.afterBuild(this.module),$(t).off("update"),$(t).on("update",_.bind(this.onUpdate,this)),t.setValue(this.attributes[t.styleObj.attributeName],!0)},e.prototype.onUpdate=function(){return this.module.updateAttributes(this.getAttributesObject()),$(this).trigger("updated:parent")},e.prototype.closeOpenChildren=function(){return this.$html.find("h5.open").trigger("click")},e.prototype.openChildModule=function(t,e){return null==e&&(e=!1),$(this).trigger("open",{child:t,withoutAnimation:e})},e.prototype.openAccordion=function(){return $(this).trigger("open")},e.prototype.closeAccordion=function(){return $(this).trigger("close")},e.prototype.getAttributesObject=function(){return this.getAttributesObjectForStyleModules()},e.prototype.getStylesWithCurrentValues=function(t){return null==t&&(t=this.styleModules),_.map(t,function(t){return _.extend(t.styleObj,{value:t.getValue()})})},e.prototype.getAttributesObjectForStyleModules=function(t){var e;return null==t&&(t=this.styleModules),e=this.getStylesWithCurrentValues(t),_.object(_.pluck(e,"attributeName"),_.pluck(e,"value"))},e.prototype.createStyleModules=function(t){return null==t&&(t=this.styles),_.map(t,function(t){return new Nlvx.DragAndDropEditor.attributes[t.type](t)})},e}(),t='<div role="style-group" class="module-style-group {{stylegroupclass styleType}}">\n  <h4>{{displayName}}</h4>\n  <div class="style-attributes" role="style-attributes"></div>\n  <div class="style-group-children" role="style-children-attributes"></div>\n</div>',Handlebars.registerHelper("stylegroupclass",function(t){var e;return e="",null!=t&&t.length&&(e="style-type-"+t),new Handlebars.SafeString(e)})}.call(this),function(){var t,e={}.hasOwnProperty,n=function(t,n){function r(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t};Nlvx.DragAndDropEditor.StyleGroup.ChildGroup=function(e){function r(e,n){this.module=e,this.parent=n,r.__super__.constructor.call(this,this.module),this.template=Handlebars.compile(t)}return n(r,e),r.prototype.afterBuild=function(){var t,e,n,r;for(this.$childStyleAttributesArea=this.$html.find("[role='child-attributes']"),r=this.styleModules,e=0,n=r.length;n>e;e++)t=r[e],this.addStyleModule(t,this.$childStyleAttributesArea);return $(this.module).off("remove:stylegroup"),$(this.module).on("remove:stylegroup",function(t){return function(){return $(t).trigger("remove",{child:t.module})}}(this))},r.prototype.openAccordion=function(t){return null==t&&(t=!1),this.parent.openAccordion(t),this.collapsible.open(t)},r.prototype.onUpdate=function(){return this.module.updateAttributes(this.getAttributesObject()),$(this).trigger("update")},r}(Nlvx.DragAndDropEditor.StyleGroup),t='<div class="module-style-group">\n  <h5>{{displayName}}</h5>\n  <div class="style-group-children-attributes" role="child-attributes"></div>\n</div>'}.call(this),function(){Nlvx.DragAndDropEditor.modules={},Nlvx.DragAndDropEditor.Module=function(){function t(t,e){null==t&&(t=""),null==e&&(e={}),this.$toolbar=$("[role='module-editor-toolbar']"),this.$html=$()}var e,n,r;return n=[],r="",e={},t.prototype.displayName="Module",t.prototype.styleType="module",t.prototype.build=function(t){return this.$parent=t,this.$parent.addClass("module-parent-container"),this.$html=$()},t.prototype.afterBuild=function(){return this.$html.data("module",this),this.bindEvents()},t.prototype.bindEvents=function(){var t,e;return this.$delete=this.$html.find("[role='module-delete']"),this.$delete.on("click",_.bind(this.removeModule,this)),this.$duplicate=this.$html.find("[role='module-duplicate']"),this.$duplicate.on("click",_.bind(this.duplicateModule,this)),e=null,t=null,this.$html.on("mouseover",function(n){return function(){return window.clearTimeout(t),e=window.setTimeout(function(){return n.$html.addClass("module-hover")},75)}}(this)),this.$html.on("mouseout",function(n){return function(){return window.clearTimeout(e),t=window.setTimeout(function(){return n.$html.removeClass("module-hover")},150)}}(this))},t.prototype.getHTML=function(){return""},t.prototype.isSelected=function(){return this.$html.hasClass("style-group-selected")},t.prototype.removeModule=function(){return this.teardown(),$(this).trigger("remove",{module:this}),$(this).trigger("remove:stylegroup"),$(this).trigger("change")},t.prototype.duplicateModule=function(t){return t.stopPropagation(),$(this).trigger("duplicate")},t.prototype.teardown=function(){return this.$html.remove()},t.prototype.rerender=function(t,e){var n;return null==t&&(t=this.attributes),null==e&&(e=this.innerHTML),this.designTemplate?(n=$(this.designTemplate({html:e,attributes:_.extend({},this.attributes,t)})),this.$html.replaceWith(n),this.$html=n,this.afterBuild()):void 0},t.prototype.updateAttributes=function(t){return null==t&&(t={}),_.extend(this.attributes,t),this.rerender(),$(this).trigger("change")},t.prototype.getStyles=function(){return n},t.prototype.getType=function(){return r},t}()}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.button=function(n){function i(n,r){this.innerHTML=null!=n?n:"",this.attributes=null!=r?r:{},i.__super__.constructor.call(this,this.innerHTML,this.attributes),this.attributes=_.extend({},o,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[{name:"Button Color",type:"ColorPicker",attributeName:"buttoncolor"},{name:"Border Color",type:"ColorPicker",attributeName:"bordercolor"},{name:"Font Color",type:"ColorPicker",attributeName:"textcolor"},{name:"",type:"Divider"},{name:"Width",type:"NumberInput",unit:"PX",attributeName:"width",canBeBlank:!0},{name:"Height",type:"NumberInput",unit:"PX",attributeName:"height",canBeBlank:!0},{name:"Padding",type:"NumberInput",inputs:4,unit:"PX",attributeName:"buttonpadding"},{name:"Border Radius",type:"NumberInput",inputs:1,unit:"PX",attributeName:"borderradius"},{name:"Font Size",type:"NumberInput",attributeName:"fontsize",unit:"PX",inputs:1},{name:"",type:"Divider"},{name:"Button Text",type:"TextInput",attributeName:"text"},{name:"Button URL",type:"TextInput",attributeName:"url"},{name:"Alignment",type:"Alignment",attributeName:"alignment"},{name:"",type:"Divider"},{name:"Container Background",type:"ColorPicker",attributeName:"containerbackground"},{name:"Container Padding",type:"NumberInput",inputs:4,unit:"PX",attributeName:"padding"}],o={borderradius:6,buttonpadding:"12,18,12,18",fontsize:16,alignment:"center",text:"Your Bulletproof Button",buttoncolor:"#1188e6",textcolor:"#ffffff",bordercolor:"#1288e5",height:"",width:"",url:"",padding:"0,0,0,0",containerbackground:"#ffffff"},i.prototype.displayName="Button",i.prototype.build=function(){return this.$html=$(this.designTemplate({attributes:this.attributes}))},i.prototype.afterBuild=function(){return this.$html.on("click",function(t){return function(){return $(t.$html).hasClass("style-group-selected")?void 0:$(t).trigger("select")}}(this)),this.$html.find("a").on("click",function(t){return t.preventDefault()}),i.__super__.afterBuild.apply(this,arguments)},i.prototype.getHTML=function(){return this.codeTemplate({attributes:this.attributes})},i.prototype.getStyles=function(){return a},i.prototype.getType=function(){return"button"},i}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module" role="module" data-type="button">\n  <tr><td style="{{buttonpadding attributes.padding}}" align="{{attributes.alignment}}" bgcolor="{{attributes.containerbackground}}">\n    <table border="0" cellpadding="0" cellspacing="0" class="wrapper-mobile">\n      <tr>\n        <td align="center" style="{{buttonborderradius attributes}} font-size: {{attributes.fontsize}}px;" bgcolor="{{attributes.buttoncolor}}">\n          <a href="{{unescapetext attributes.url}}" class="bulletproof-button" target="_blank" style="height: {{attributes.height}}px; width: {{attributes.width}}px; font-size: {{attributes.fontsize}}px; line-height: {{attributes.height}}px; font-family: Helvetica, Arial, sans-serif; color: {{attributes.textcolor}}; {{buttonpadding attributes.buttonpadding}} text-decoration: none; color: {{attributes.textcolor}}; text-decoration: none; {{buttonborderradius attributes}} border: 1px solid {{attributes.bordercolor}}; display: inline-block;">{{unescapetext attributes.text}}</a>\n        </td>\n      </tr>\n    </table>\n    <div class="module-controls" role="module-controls">\n      <span class="module-controls__move"></span>\n      <span class="module-controls__delete" role="module-delete"></span>\n      <span class="module-controls__duplicate" role="module-duplicate"></span>\n    </div>\n  </td></tr>\n</table>',t='<table class="module" role="module" data-type="button" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" data-attributes=\'{{{buttonsaveattributes attributes}}}\'>\n<tr>\n  <td style="{{buttonpadding attributes.padding}}" align="{{attributes.alignment}}" bgcolor="{{attributes.containerbackground}}">\n    <table border="0" cellpadding="0" cellspacing="0" class="wrapper-mobile">\n      <tr>\n        <td align="center" style="{{buttonborderradius attributes}} font-size: {{attributes.fontsize}}px;" bgcolor="{{attributes.buttoncolor}}">\n          <a href="{{unescapetext attributes.url}}" class="bulletproof-button" target="_blank" style="height: {{attributes.height}}px; width: {{attributes.width}}px; font-size: {{attributes.fontsize}}px; line-height: {{attributes.height}}px; font-family: Helvetica, Arial, sans-serif; color: {{attributes.textcolor}}; {{buttonpadding attributes.buttonpadding}} text-decoration: none; color: {{attributes.textcolor}}; text-decoration: none; {{buttonborderradius attributes}} border: 1px solid {{attributes.bordercolor}}; display: inline-block;">{{unescapetext attributes.text}}</a>\n        </td>\n      </tr>\n    </table>\n  </td>\n</tr>\n</table>\n',Handlebars.registerHelper("buttonsaveattributes",function(t){var e,n;return e={dropped:!0,borderradius:t.borderradius,buttonpadding:t.buttonpadding,text:t.text,alignment:t.alignment,fontsize:t.fontsize,url:t.url,height:t.height||"",width:t.width||"",containerbackground:t.containerbackground,padding:t.padding,buttoncolor:t.buttoncolor,textcolor:t.textcolor,bordercolor:t.bordercolor},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("unescapetext",function(t){return new Handlebars.SafeString(unescape(t))}),Handlebars.registerHelper("buttonpadding",function(t){return new Handlebars.SafeString("padding: "+t.split(",").join("px ")+"px;")}),Handlebars.registerHelper("buttonborderradius",function(t){var e;return e=t.borderradius,new Handlebars.SafeString("-webkit-border-radius: "+e+"px; -moz-border-radius: "+e+"px; border-radius: "+e+"px;")})}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.columns=function(n){function i(n,r){this.innerHTML=null!=n?n:"",null==r&&(r={}),i.__super__.constructor.call(this,this.innerHTML,r),this.attributes=_.extend({},o,r),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[{name:"Container Background",type:"ColorPicker",attributeName:"containerbackground"},{name:"Container Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"padding"},{name:"Cell Padding",type:"NumberInput",unit:"PX",inputs:1,attributeName:"cellpadding"},{name:"Columns",type:"Range",min:1,max:4,unit:"/4",attributeName:"columns"}],o={containerbackground:"",padding:"0,0,0,0",cellpadding:0,columns:2},i.prototype.displayName="Columns",i.prototype.hasChildren=!0,i.prototype.build=function(){return i.__super__.build.apply(this,arguments),this.$html=$(this.designTemplate({attributes:this.attributes}))},i.prototype.afterBuild=function(t){var e;return null==t&&(t=!1),this.attributes.dropped?this.createFromExisting():(this.createNew(),this.attributes.dropped=!0),this.$html.on("click",".column-drop-area.empty",function(t){return function(){var e;return $(t.$html).hasClass("style-group-selected")?void 0:(null!=(e=t.styleGroup)&&e.closeOpenChildren(),$(t).trigger("select"))}}(this)),null!=(e=this.styleGroup)&&e.buildChildModules(),i.__super__.afterBuild.apply(this,arguments)},i.prototype.bindEvents=function(){var t,e;return this.$delete=this.$html.find(".columns--container-table").next("[role='module-controls']").find("[role='module-delete']"),this.$delete.on("click",_.bind(this.removeModule,this)),this.$duplicate=this.$html.find(".columns--container-table").next("[role='module-controls']").find("[role='module-duplicate']"),this.$duplicate.on("click",_.bind(this.duplicateModule,this)),e=null,t=null,this.$html.on("mouseover",function(n){return function(){return window.clearTimeout(t),e=window.setTimeout(function(){return n.$html.addClass("module-hover")},75)}}(this)),this.$html.on("mouseout",function(n){return function(){return window.clearTimeout(e),t=window.setTimeout(function(){return n.$html.removeClass("module-hover")},150)}}(this))},i.prototype.getChildModules=function(){return _.map(this.$html.find(".column-drop-area > [role='module']"),function(t){return $(t).data("module")})},i.prototype.getColumnsHTML=function(){return _.map(this.$html.find(".column-drop-area"),function(t){var e;return e=_.map($(t).find("> [role='module']"),function(t){return $(t).data("module")}),_.map(e,function(t){return(null!=t?t.getHTML():void 0)||""}).join("")})},i.prototype.getHTML=function(){var t;return t=this.getColumnsHTML(),this.codeTemplate({attributes:this.attributes,columnsHTML:t})},i.prototype.createFromExisting=function(){var t;return t=$("<tr>"+this.innerHTML+"</tr>"),_(this.attributes.columns).times(function(e){return function(n){var r,i;return r=e.$html.find("[role='column-"+n+"']"),i=t.find("[role='column-"+n+"']").html(),e.createColumn(r,i)}}(this))},i.prototype.createColumn=function(t,e){var n;return n=new Nlvx.DragAndDropEditor.ColumnsEditor(t,e,this),this.bindEditorEvents(n)},i.prototype.bindEditorEvents=function(t){return $(t).on({change:function(t){return function(){return t.innerHTML=$(t.getHTML()).find("[role='module-content']").html(),$(t).trigger("change")}}(this),renderstyletab:function(t){return function(){return $(t).trigger("renderstyletab")}}(this),renderstyletabandopen:function(t){return function(){return $(t).trigger("renderstyletabandopen")}}(this),removeChild:function(t){return function(){return t.innerHTML=$(t.getHTML()).find("[role='module-content']").html()}}(this)})},i.prototype.createNew=function(){return _(this.attributes.columns).times(function(t){return function(e){var n;return n=t.$html.find("[role='column-"+e+"']"),t.createColumn(n,null)}}(this))},i.prototype.getStyles=function(){return a},i.prototype.updateAttributes=function(t){var e;return e=this.attributes.columns,t.columns=parseInt(t.columns),i.__super__.updateAttributes.call(this,t),e!==t.columns?$(this).trigger("renderstyletabandopen"):void 0},i.prototype.rerender=function(t,e){var n;return null==t&&(t=this.attributes),null==e&&(e=this.innerHTML),this.designTemplate?(n=$(this.designTemplate({html:e,attributes:_.extend({},this.attributes,t)})),this.$html.replaceWith(n),this.$html=n,this.afterBuild(!0)):void 0},i.prototype.teardown=function(){return _.each(this.getChildModules(),function(t){return t.teardown()}),i.__super__.teardown.apply(this,arguments)},i.prototype.getType=function(){return"columns"},i}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module columns" role="module" data-type="columns">\n  <tr><td style="{{columnspadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n    <table class="columns--container-table" border="0" cellpadding="0" cellspacing="0" align="center" width="100%">\n      <tr role="module-content">\n        {{columns attributes}}\n      </tr>\n    </table>\n    <div class="module-controls" role="module-controls">\n      <span class="module-controls__move"></span>\n      <span class="module-controls__delete" role="module-delete"></span>\n      <span class="module-controls__duplicate" role="module-duplicate"></span>\n    </div>\n  </td></tr>\n</table>',t='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" role="module" data-type="columns" data-attributes=\'{{{columnssaveattributes attributes}}}\'>\n  <tr><td style="{{columnspadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n    <table class="columns--container-table" border="0" cellpadding="0" cellspacing="0" align="center" width="100%">\n      <tr role="module-content">\n        {{columns attributes columnsHTML}}\n      </tr>\n    </table>\n  </td></tr>\n</table>',Handlebars.registerHelper("columns",function(t,e){var n,r,i,o,a,l;return null==e&&(e=[""]),r=t.columns||2,a=100/r,l=[t.cellpadding,t.cellpadding],i=l[0],o=l[1],n=_.map(Array(r),function(n,l){var s,u,d,c;return(null!=(d=e[l])?d.length:void 0)?(u=e[l],s=""):(u="",s="empty"),r>1&&(c=[t.cellpadding/2,t.cellpadding/2],i=c[0],o=c[1],0===l?i=0:l%(r-1)===0&&(o=0)),'<td style="padding: 0px '+o+"px 0px "+i+'px" role="column-'+l+'" align="center" valign="top" width="'+a+'%" height="100%" class="templateColumnContainer column-drop-area '+s+'">\n  '+u+"\n</td>"}).join(""),new Handlebars.SafeString(n)}),Handlebars.registerHelper("columnssaveattributes",function(t){var e,n;return e={dropped:!0,columns:t.columns||2,padding:t.padding||"",cellpadding:t.cellpadding||0,containerbackground:t.containerbackground||""},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("columnspadding",function(t){var e;return e=t.padding,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")})}.call(this),function(){var t,e,n,r,i,o={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.footer=function(t){function o(t,n){this.innerHTML=null!=t?t:"",null==n&&(n={}),o.__super__.constructor.call(this,this.innerHTML,n),this.attributes=_.extend({},l,n),this.designTemplate=Handlebars.compile(i),this.codeTemplate=Handlebars.compile(e)}var l,s;return a(o,t),s=[{name:"Container Background",type:"ColorPicker",attributeName:"containerbackground"},{name:"Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"padding"},{name:"Columns",type:"Range",min:1,max:2,unit:"/2",attributeName:"columns"}],l={containerbackground:"#ffffff",padding:"10,5,10,5",columns:1},o.prototype.displayName="Footer",o.prototype.build=function(){return this.$html=$(this.designTemplate({attributes:this.attributes}))},o.prototype.afterBuild=function(){return this.attributes.dropped?this.parseChildren():this.createNew(),this.attributes.dropped=!0,o.__super__.afterBuild.apply(this,arguments)},o.prototype.getHTML=function(){var t,e,n,r;return t=(null!=(n=this.module1)?n.getHTML():void 0)||"",e=(null!=(r=this.module2)?r.getHTML():void 0)||"",this.codeTemplate({attributes:this.attributes,module1:t,module2:e})},o.prototype.parseChildren=function(){var t,e;return null!=this.module1&&(this.innerHTML=$(this.getHTML()).find("[role='module-content']").first().html()),e=new Nlvx.DragAndDropEditor.Parser(this.innerHTML),t=e.getChildModules(),t.length?(this.module1=t[0],this.buildModule(this.module1,this.$html.find("[role='column-one']")),this.attributes.columns>1&&(this.module2=t[1]||new Nlvx.DragAndDropEditor.modules.text(r,{dropped:!0}),this.module2)?this.buildModule(this.module2,this.$html.find("[role='column-two']")):void 0):this.createNew()},o.prototype.createNew=function(){return this.module1=new Nlvx.DragAndDropEditor.modules.text(n,{dropped:!0}),this.buildModule(this.module1,this.$html.find("[role='column-one']")),this.attributes.columns>1?(this.module2=new Nlvx.DragAndDropEditor.modules.text(r,{dropped:!0}),this.buildModule(this.module2,this.$html.find("[role='column-two']"))):void 0},o.prototype.buildModule=function(t,e){return e.append(t.build()),t.afterBuild(),this.bindModuleEvents(t)},o.prototype.bindModuleEvents=function(t){return $(t).on({change:function(t){return function(){return $(t).trigger("change")}}(this),select:function(t){return function(){return $(t).trigger("select")}}(this)})},o.prototype.getStyles=function(){return s},o.prototype.rerender=function(t,e){return null==t&&(t=this.attributes),null==e&&(e=this.innerHTML),o.__super__.rerender.call(this,t,e),this.updateChildColumnsBGs()},o.prototype.updateAttributes=function(t){return t.columns<2&&(this.module2=null),o.__super__.updateAttributes.call(this,t),this.updateChildColumnsBGs()},o.prototype.updateChildColumnsBGs=function(){var t,e;return null!=(t=this.module1)&&t.updateAttributes({containerbackground:this.attributes.containerbackground}),null!=(e=this.module2)?e.updateAttributes({containerbackground:this.attributes.containerbackground}):void 0},o.prototype.teardown=function(){var t,e;return null!=(t=this.module1)&&t.teardown(),null!=(e=this.module2)&&e.teardown(),o.__super__.teardown.apply(this,arguments)},o.prototype.getType=function(){return"footer"},o}(Nlvx.DragAndDropEditor.Module),i='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module footer" role="module" data-type="footer">\n  <tr><td style="{{footerpadding attributes}}"  bgcolor="{{attributes.containerbackground}}">\n    <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%">\n      <tr>{{footercolumns attributes}}</tr>\n    </table>\n  </td></tr>\n</table>',e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module footer" role="module" data-type="footer" data-attributes=\'{{{footersaveattributes attributes}}}\'>\n  <tr><td style="{{footerpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n    <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%">\n      <tr role="module-content">\n        {{#if module2.length}}\n        <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer">\n          <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n            <tr>\n              <td class="leftColumnContent" role="column-one" height="100%" style="height:100%;">{{{module1}}}</td>\n            </tr>\n          </table>\n        </td>\n        <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer">\n          <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n            <tr>\n              <td class="rightColumnContent" role="column-two" height="100%" style="height:100%;">{{{module2}}}</td>\n            </tr>\n          </table>\n        </td>\n        {{else}}\n        <td align="center" valign="top" width="100%" height="100%" class="templateColumnContainer">\n          <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n            <tr>\n              <td class="leftColumnContent" role="column-one" height="100%" style="height:100%;">{{{module1}}}</td>\n            </tr>\n          </table>\n        </td>\n        {{/if}}\n      </tr>\n    </table>\n  </td></tr>\n</table>\n',n='<div style="font-size:12px;line-height:150%;margin:0;text-align:center;">\n  This email was sent by: [Sender_Name] [Sender_Address], [Sender_City] [Sender_State] [Sender_Zip]\n</div>\n<div style="font-size:12px;line-height:150%;margin:0;text-align:center;">\n  To unsubscribe click: <a href="[Unsubscribe]">here</a>\n</div>',r='<p style="font-size:12px;line-height:150%;margin:0;text-align:center;">For more information, check out our website or contact our support team.</p>',Handlebars.registerHelper("footersaveattributes",function(t){var e,n;return e={dropped:!0,columns:t.columns,padding:t.padding,containerbackground:t.containerbackground},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("footercolumns",function(t){var e;return e="",t.columns>1?_(t.columns).times(function(t){var n,r;return 1>t?(n="left",r="one"):(n="right",r="two"),e+='<td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer">\n  <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n    <tr>\n      <td class="'+n+'ColumnContent" role="column-'+r+'" height="100%" style="height:100%;"></td>\n    </tr>\n  </table>\n</td>'}):e='<td align="center" valign="top" width="100%" height="100%" class="templateColumnContainer">\n    <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n      <tr>\n        <td class="leftColumnContent" role="column-one" height="100%" style="height:100%;"></td>\n      </tr>\n    </table>\n  </td>',new Handlebars.SafeString(e)}),Handlebars.registerHelper("footerpadding",function(t){var e;return e=t.padding,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")}),t={startupFocus:!1,title:!1,sharedSpaces:{top:"module-editor__toolbar"},toolbar:[{name:"colors",items:["TextColor","BGColor"]},{name:"styles",items:["Format","Font","FontSize"]},{name:"basic styles",items:["Bold","Italic","Underline","RemoveFormat"]},{name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight"]},{name:"lists",items:["NumberedList","BulletedList"]},{name:"misc",items:["Table","Sglink","HorizontalRule"]}]}}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.image=function(n){function i(n,r){this.innerHTML=null!=n?n:"",null==r&&(r={}),this.attributes=_.extend({},o,r),i.__super__.constructor.call(this,this.innerHTML,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[{name:"Edit",type:"Button",label:"Image Properties",callback:function(t){return t.openImageManager()},altText:"You can also double click an image to open the image manager.",cssClasses:"btn btn-secondary btn-small",attributeName:"open_image_manager"},{name:"",type:"Divider"},{name:"Image Background",type:"ColorPicker",attributeName:"imagebackground"},{name:"Image Margin",type:"NumberInput",attributeName:"imagemargin",inputs:4,unit:"PX"}],o={link:"",alt_text:"",padding:"0,0,0,0",alignment:"left",imagebackground:"#FFFFFF",imagemargin:"0,0,0,0",responsive:!1},i.prototype.displayName="Image",i.prototype.build=function(){return i.__super__.build.apply(this,arguments),this.$html=$(this.designTemplate({attributes:this.attributes})),this.attributes.dropped||this.openImageManager(),this.$html},i.prototype.afterBuild=function(){return this.$html.data("module",this),this.$html.on("dblclick",function(t){return function(){return t.openImageManager()}}(this)),this.$html.on("click",function(t){return function(){return $(t).trigger("select")}}(this)),this.$html.find("a").on("click",function(t){return t.preventDefault()}),i.__super__.afterBuild.apply(this,arguments)},i.prototype.getHTML=function(){return this.codeTemplate({attributes:this.attributes})},i.prototype.teardown=function(){return null!=this.imageManager&&this.imageManager.teardown(),this.imageManager=null,i.__super__.teardown.apply(this,arguments)},i.prototype.updateHTML=function(){return this.rerender(),$(this).trigger("change")},i.prototype.openImageManager=function(){return this.imageManager=new Nlvx.ImageManager($("body")),null!=this.attributes.url&&this.imageManager.setImage(this.attributes),this.bindImageManagerEvents()},i.prototype.bindImageManagerEvents=function(){return $(this.imageManager).on({insert:function(t){return function(e,n){return t.attributes=_.extend(t.attributes,n),t.attributes.dropped=!0,t.updateHTML(),$(t).trigger("renderstyletabandopen")}}(this)})},i.prototype.getStyles=function(){return a},i.prototype.getType=function(){return"image"},i}(Nlvx.DragAndDropEditor.Module),Handlebars.registerHelper("image",function(t){var e,n,r,i,o,a,l,s,u,d;return s=t.url,e=Handlebars.Utils.escapeExpression(t.alt_text),i="",r="",a="",o="",l="",(null!=(d=t.link)?d.length:void 0)&&(i='<a href="'+t.link+'" target="_blank">',r="</a>"),u=' width="'+t.width+'" ',n=' height="'+t.height+'" ',t.responsive&&(a='<!--[if mso]>\n<center>\n<table width="'+t.width+'" border="0" cellpadding="0" cellspacing="0" style="table-layout: fixed;">\n  <tr>\n    <td width="'+t.width+'" valign="top">\n<![endif]-->',o="<!--[if mso]>\n</td></tr></table>\n</center>\n<![endif]-->",n=' height="" ',u=' width="'+t.width+'" ',l=" max-width: "+t.width+"px !important; width: 100% !important; height: auto !important; "),new Handlebars.SafeString(t=""+a+"\n"+i+'\n  <img class="max-width" '+u+" "+n+' src="'+s+'" alt="'+e+'" border="0" style="display: block; color: #000; text-decoration: none; font-family: Helvetica, arial, sans-serif; font-size: 16px; '+l+'" />\n'+r+"\n"+o)}),Handlebars.registerHelper("imagesaveattributes",function(t){var e,n;return e={child:t.child||!1,link:t.link,width:t.width,height:t.height,imagebackground:t.imagebackground,url:t.url,alt_text:t.alt_text,dropped:!0,imagemargin:t.imagemargin,alignment:t.alignment,responsive:t.responsive},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("imagemargin",function(t){var e;return e=t.imagemargin,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")}),e='<table role="module" data-type="image" border="0" cellpadding="0" cellspacing="0" width="100%" {{#attributes.child}}height="100%"{{/attributes.child}} class="wrapper module">\n  <tr><td align="{{attributes.alignment}}" valign="top" style="{{#attributes.child}}height:100%;{{/attributes.child}};background-color:{{attributes.imagebackground}}; {{imagemargin attributes}}">\n  {{#attributes.url}}\n    {{{image ../attributes}}}\n  {{else}}\n    <div class="module-image--placeholder">\n      <span class="module-image--placeholder__icon"></span>\n      <p class="module-image--placeholder__text">Add Image</p>\n    </div>\n  {{/attributes.url}}\n  <div class="module-controls">\n    <span class="module-controls__move"></span>\n    <span class="module-controls__delete" role="module-delete"></span>\n    <span class="module-controls__duplicate" role="module-duplicate"></span>\n  </div>\n  </td></tr>\n</table>',t='<table role="module" data-type="image" border="0" align="center" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" class="wrapper" data-attributes=\'{{imagesaveattributes attributes}}\'>\n<tr>\n  <td style="font-size:6px;line-height:10px;background-color:{{attributes.imagebackground}};{{imagemargin attributes}}" valign="top" align="{{attributes.alignment}}" role="module-content">{{{image attributes}}}</td>\n</tr>\n</table>'
}.call(this),function(){var t,e,n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.imagetext=function(n){function r(n,i){this.innerHTML=null!=n?n:"",null==i&&(i={}),this.attributes=_.extend({},o,i),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t),r.__super__.constructor.apply(this,arguments)}var o,a;return i(r,n),a=[{name:"Edit",type:"Button",label:"Image Properties",callback:function(t){return t.getImageModule().openImageManager()},altText:"You can also double click an image to open the image manager.",cssClasses:"btn btn-secondary btn-small",attributeName:"open_image_manager"},{name:"",type:"Divider"},{name:"Image Position",type:"Alignment",attributeName:"imagealignment",center:!1},{name:"Image Background",type:"ColorPicker",attributeName:"imagebackground"},{name:"Image Margin",type:"NumberInput",attributeName:"imagemargin",inputs:4,unit:"PX"},{name:"",type:"Divider"},{name:"Text Background",type:"ColorPicker",attributeName:"textbackground"},{name:"Text Margin",type:"NumberInput",attributeName:"textmargin",inputs:4,unit:"PX"}],o={imagebackground:"#ffffff",textbackground:"#ffffff",imagealignment:"left",imagemargin:"0,0,0,0",textmargin:"0,0,0,0"},r.prototype.displayName="Image + Text",r.prototype.build=function(){return r.__super__.build.apply(this,arguments),this.$html=$(this.designTemplate({html:this.innerHTML,attributes:this.attributes}))},r.prototype.afterBuild=function(){return this.attributes.dropped?this.parseChildren():this.createNew(),r.__super__.afterBuild.apply(this,arguments)},r.prototype.getHTML=function(){var t,e,n,r;return t=(null!=(n=this.module1)?n.getHTML():void 0)||"",e=(null!=(r=this.module2)?r.getHTML():void 0)||"",this.codeTemplate({attributes:this.attributes,module1:t,module2:e})},r.prototype.teardown=function(){var t,e;return null!=(t=this.module1)&&t.teardown(),null!=(e=this.module2)&&e.teardown(),r.__super__.teardown.apply(this,arguments)},r.prototype.getStyles=function(){return a},r.prototype.getType=function(){return"imagetext"},r.prototype.parseChildren=function(){var t,e,n,r;return null!=this.module1&&null!=this.module2&&(this.innerHTML=$(this.getHTML()).find("[role='module-content']").first().html()),n=new Nlvx.DragAndDropEditor.Parser(this.innerHTML),e=n.getChildModules(),t=this.attributes.imagebackground,r=this.attributes.textbackground,"left"===this.attributes.imagealignment?(this.module1="image"===e[0].getType()?e[0]:e[1],this.module2="text"===e[0].getType()?e[0]:e[1]):(this.module1="text"===e[0].getType()?e[0]:e[1],this.module2="image"===e[0].getType()?e[0]:e[1]),this.module1&&this.buildModule(this.module1,this.$html.find("[role='column-one']")),this.module2?this.buildModule(this.module2,this.$html.find("[role='column-two']")):void 0},r.prototype.createNew=function(){var t,e;return t=this.attributes.imagebackground,e=this.attributes.textbackground,"left"===this.attributes.imagealignment?(this.module1=new Nlvx.DragAndDropEditor.modules.image(null,{dropped:!0,child:!0,imagebackground:t}),this.module2=new Nlvx.DragAndDropEditor.modules.text(null,{dropped:!0,child:!0,containerbackground:e})):(this.module1=new Nlvx.DragAndDropEditor.modules.text(null,{dropped:!0,child:!0,containerbackground:e}),this.module2=new Nlvx.DragAndDropEditor.modules.image(null,{dropped:!0,child:!0,imagebackground:t})),this.buildModule(this.module1,this.$html.find("[role='column-one']")),this.buildModule(this.module2,this.$html.find("[role='column-two']"))},r.prototype.buildModule=function(t,e){return e.append(t.build(e)),t.afterBuild(),this.bindModuleEvents(t)},r.prototype.bindModuleEvents=function(t){return $(t).on({change:function(t){return function(){return $(t).trigger("change")}}(this),select:function(t){return function(){return $(t).trigger("select")}}(this)})},r.prototype.getImageModule=function(){return null!=this.module1&&null!=this.module2?"image"===this.module1.getType()?this.module1:this.module2:void 0},r.prototype.getTextModule=function(){return null!=this.module1&&null!=this.module2?"text"===this.module1.getType()?this.module1:this.module2:void 0},r.prototype.updateAttributes=function(t){return null==t&&(t={}),r.__super__.updateAttributes.call(this,t),this.getImageModule().updateAttributes({imagebackground:this.attributes.imagebackground}),this.getTextModule().updateAttributes({containerbackground:this.attributes.textbackground})},r}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module wrapper" role="module" data-type="imagetext">\n  <tr>\n    <td>\n      <table border="0" cellpadding="0" cellspacing="0" width="100%">\n        <tr role="module-content">\n          <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer" {{imagetextbackgroundcolor attributes 1}}>\n            <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n              <tr>\n                <td class="leftColumnContent" role="column-one" height="100%" style="height:100%;width:50%; {{imagetextpadding attributes 1}}"></td>\n              </tr>\n            </table>\n          </td>\n          <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer" {{imagetextbackgroundcolor attributes 2}}>\n            <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n              <tr>\n                <td class="rightColumnContent" role="column-two" height="100%" style="height:100%;width:50%; {{imagetextpadding attributes 2}}"></td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n      </table>\n      <div class="module-controls">\n        <span class="module-controls__move"></span>\n        <span class="module-controls__delete" role="module-delete"></span>\n        <span class="module-controls__duplicate" role="module-duplicate"></span>\n      </div>\n    </td>\n  </tr>\n</table>',t='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module wrapper" role="module" data-type="imagetext" data-attributes=\'{{imagetextsaveattributes attributes}}\'>\n  <tr>\n    <td>\n      <table border="0" cellpadding="0" cellspacing="0" width="100%">\n        <tr role="module-content">\n          <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer" {{imagetextbackgroundcolor attributes 1}}>\n            <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n              <tr>\n                <td class="leftColumnContent" role="column-one" height="100%" style="height:100%;width:50%; {{imagetextpadding attributes 1}}">{{{module1}}}</td>\n              </tr>\n            </table>\n          </td>\n          <td align="center" valign="top" width="50%" height="100%" class="templateColumnContainer" {{imagetextbackgroundcolor attributes 2}}>\n            <table border="0" cellpadding="0" cellspacing="0" width="100%" height="100%">\n              <tr>\n                <td class="rightColumnContent" role="column-two" height="100%" style="height:100%;width:50%; {{imagetextpadding attributes 2}}">{{{module2}}}</td>\n              </tr>\n            </table>\n          </td>\n        </tr>\n      </table>\n    </td>\n  </tr>\n</table>\n',Handlebars.registerHelper("imagetextbackgroundcolor",function(t,e){var r,i;return i=n(t,e),"image"===i?r=t.imagebackground:"text"===i&&(r=t.textbackground),new Handlebars.SafeString(' bgcolor="'+r+'" ')}),Handlebars.registerHelper("imagetextpadding",function(t,e){var r,i;return r=n(t,e),"image"===r?i=t.imagemargin:"text"===r&&(i=t.textmargin),new Handlebars.SafeString("padding: "+i.split(",").join("px ")+"px;")}),n=function(t,e){return"left"===t.imagealignment?1===e?"image":"text":1===e?"text":"image"},Handlebars.registerHelper("imagetextsaveattributes",function(t){var e,n;return e={dropped:!0,imagebackground:t.imagebackground,imagemargin:t.imagemargin,textbackground:t.textbackground,textmargin:t.textmargin,imagealignment:t.imagealignment},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)})}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.preheader=function(n){function i(n,r){this.innerHTML=null!=n?n:"",null==r&&(r={}),i.__super__.constructor.call(this,this.innerHTML,r),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[],o={},i.prototype.displayName="Preheader",i.prototype.build=function(){return this.$html=$(),$("#campaign_campaign_content_preheader").val(this.designTemplate({html:this.innerHTML}))},i.prototype.bindEvents=function(){return $("#campaign_campaign_content_preheader").on("change blur",function(t){return function(){return t.innerHTML=t.getInputValue(),$(t).trigger("change")}}(this))},i.prototype.getHTML=function(){return this.codeTemplate({html:this.getInputValue()})},i.prototype.getInputValue=function(){return Nlvx.Sanitizers.removeJavascript($("#campaign_campaign_content_preheader").val())},i.prototype.buildModule=function(t,e){return e.append(t.build()),t.afterBuild(),this.bindModuleEvents(t)},i.prototype.getStyles=function(){return a},i.prototype.rerender=function(t,e){return null==t&&(t=this.attributes),null==e&&(e=this.innerHTML),$("#campaign_campaign_content_preheader").val(this.innerHTML)},i.prototype.updateAttributes=$.noop,i.prototype.teardown=$.noop,i.prototype.getType=function(){return"preheader"},i}(Nlvx.DragAndDropEditor.Module),e="{{{sanitize html}}}",t='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" style="{{hidestyle}}" class="module preheader preheader-hide" role="module" data-type="preheader">\n  <tr><td role="module-content"><p>{{{sanitize html}}}</p></td></tr>\n</table>\n',Handlebars.registerHelper("sanitize",function(t){return Nlvx.Sanitizers.removeJavascript(t)}),Handlebars.registerHelper("hidestyle",function(){var t;return t=["display:none !important;","visibility:hidden;","opacity:0;","color:transparent;","height:0;","width:0;"].join(" "),new Handlebars.SafeString(t)})}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.spacer=function(n){function i(n,r){this.innerHTML=null!=n?n:"",this.attributes=null!=r?r:{},i.__super__.constructor.call(this,this.innerHTML,this.attributes),this.attributes=_.extend({},o,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[{name:"Background Color",type:"ColorPicker",attributeName:"containerbackground"},{name:"Spacing",type:"NumberInput",unit:"PX",attributeName:"spacing"}],o={containerbackground:"#ffffff",spacing:30},i.prototype.displayName="Spacer",i.prototype.build=function(){return this.$html=$(this.designTemplate({attributes:this.attributes}))},i.prototype.afterBuild=function(){return this.$html.on("click",function(t){return function(){return $(t.$html).hasClass("style-group-selected")?void 0:$(t).trigger("select")}}(this)),i.__super__.afterBuild.apply(this,arguments)},i.prototype.getHTML=function(){return this.codeTemplate({attributes:this.attributes})},i.prototype.getStyles=function(){return a},i.prototype.getType=function(){return"spacer"},i}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module" role="module" data-type="spacer">\n  <tr><td style="{{spacerpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n    <div class="module-controls" role="module-controls">\n      <span class="module-controls__move"></span>\n      <span class="module-controls__delete" role="module-delete"></span>\n      <span class="module-controls__duplicate" role="module-duplicate"></span>\n    </div>\n  </td></tr>\n</table>',t='<table class="module" role="module" data-type="spacer" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" data-attributes=\'{{{spacersaveattributes attributes}}}\'>\n<tr><td role="module-content" style="{{spacerpadding attributes}}" bgcolor="{{attributes.containerbackground}}"></td></tr></table>\n',Handlebars.registerHelper("spacersaveattributes",function(t){var e,n;return e={dropped:!0,spacing:t.spacing||0,containerbackground:t.containerbackground},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("spacerpadding",function(t){return new Handlebars.SafeString("padding: 0px 0px "+t.spacing+"px 0px;")})}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.wysiwyg=function(n){function i(n,r){this.innerHTML=null!=n?n:"<div>Type Something</div>",this.attributes=null!=r?r:{},this.attributes=_.extend({},o,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t),this.scopedDocClick=_.bind(this.onDocumentClick,this),i.__super__.constructor.apply(this,arguments)}var o,a;return r(i,n),a=[{name:"Background Color",type:"ColorPicker",attributeName:"containerbackground"},{name:"Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"padding"}],o={containerbackground:"#ffffff",padding:"0,0,0,0"},i.prototype.displayName="Wysiwyg",i.prototype.build=function(){return this.$html=$(this.designTemplate({html:this.innerHTML,attributes:this.attributes}))},i.prototype.afterBuild=function(){return this.$html.data("module",this),this.$editor=this.$html.find("[role='module-editor']"),i.__super__.afterBuild.apply(this,arguments)},i.prototype.bindEvents=function(){return this.$editor.on({focus:function(t){return function(){return t.$toolbar.addClass("active"),t.editor?void 0:($("[role='main']").trigger("click"),$(t).trigger("select"),t.createEditor())}}(this),blur:function(t){return function(){return t.innerHTML=t.getEditorData()||t.innerHTML,t.$toolbar.removeClass("active"),$(t).trigger("change")}}(this)}),this.$html.on("click",function(t){return function(){return t.$editor.trigger("focus")}}(this)),i.__super__.bindEvents.apply(this,arguments)},i.prototype.bindCloseEditorEvents=function(){return $("[role='main']").on("click",this.scopedDocClick),this.$html.on("click",this.stopPropClicks),$("#drag_and_drop_editor").on("click","*",this.stopPropClicks)},i.prototype.unbindCloseEditorEvents=function(){return $("[role='main']").off("click",this.scopedDocClick),this.$html.off("click",this.stopPropClicks),$("#drag_and_drop_editor").off("click","*",this.stopPropClicks)},i.prototype.getHTML=function(){var t;return t=this.getEditorData()||this.innerHTML,this.codeTemplate({html:t,attributes:this.attributes})},i.prototype.teardown=function(){return this.onDocumentClick(),i.__super__.teardown.apply(this,arguments)},i.prototype.getStyles=function(){return a},i.prototype.getType=function(){return"wysiwyg"},i.prototype.createEditor=function(t){var e;return null==t&&(t=Nlvx.DragAndDropEditor.ckConfig),e=_.extend({change:_.bind(this.onEditorChange,this)},t),this.$editor.ckeditor(e),this.editor=this.$editor.ckeditor().editor,this.editor.on("change",_.bind(this.onEditorChange,this)),this.$toolbar.addClass("active"),this.bindCloseEditorEvents()},i.prototype.onDocumentClick=function(){return this.editor?(this.editor.destroy(!0),this.editor=null,this.unbindCloseEditorEvents()):void 0},i.prototype.getEditorData=function(){var t;return null!=(null!=(t=this.editor)?t.getData:void 0)?this.editor.getData().replace(/(\r\n|\n|\r)/gm," "):void 0},i.prototype.onEditorChange=function(){return this.innerHTML=this.getEditorData()||this.innerHTML,$(this).trigger("change")},i.prototype.stopPropClicks=function(t){return t.stopPropagation()},i}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module" role="module" data-type="wysiwyg">\n  <tr><td style="{{wysiwygpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n  <div role="module-editor" contenteditable="true">{{{html}}}</div>\n  <div class="module-controls">\n    <span class="module-controls__move"></span>\n    <span class="module-controls__delete" role="module-delete"></span>\n    <span class="module-controls__duplicate" role="module-duplicate"></span>\n  </div>\n  </td></tr>\n</table>',t='<table class="module" role="module" data-type="wysiwyg" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" data-attributes=\'{{{wysiwygsaveattributes attributes}}}\'>\n<tr><td role="module-content" style="{{wysiwygpadding attributes}}" bgcolor="{{attributes.containerbackground}}">{{{html}}}</td></tr></table>\n',Handlebars.registerHelper("wysiwygpadding",function(t){var e;return e=t.padding,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")}),Handlebars.registerHelper("wysiwygsaveattributes",function(t){var e,n;return e={dropped:!0,padding:t.padding,containerbackground:t.containerbackground},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)})}.call(this),function(){var t,e,n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.text=function(r){function o(t,r){this.innerHTML=null!=t?t:"<div>Type Something</div>",this.attributes=null!=r?r:{},o.__super__.constructor.call(this,this.innerHTML,this.attributes),this.designTemplate=Handlebars.compile(n),this.codeTemplate=Handlebars.compile(e)}return i(o,r),o.prototype.displayName="Text",o.prototype.createEditor=function(){return o.__super__.createEditor.call(this,t)},o.prototype.getType=function(){return"text"},o}(Nlvx.DragAndDropEditor.modules.wysiwyg),n='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" {{#attributes.child}}height="100%"{{/attributes.child}} class="module" role="module" data-type="text">\n  <tr><td valign="top" {{#attributes.child}}height="100%"{{/attributes.child}} style="{{wysiwygpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n  <div role="module-editor" contenteditable="true">{{{html}}}</div>\n  <div class="module-controls" role="module-controls">\n    <span class="module-controls__move"></span>\n    <span class="module-controls__delete" role="module-delete"></span>\n    <span class="module-controls__duplicate" role="module-duplicate"></span>\n  </div>\n  </td></tr>\n</table>',e='<table class="module" role="module" data-type="text" border="0" cellpadding="0" cellspacing="0" {{#attributes.child}}height="100%"{{/attributes.child}} width="100%" style="table-layout: fixed;" data-attributes=\'{{{textsaveattributes attributes}}}\'>\n<tr>\n  <td role="module-content"  valign="top" height="100%" style="{{wysiwygpadding attributes}}" bgcolor="{{attributes.containerbackground}}">{{{html}}}</td>\n</tr>\n</table>\n',Handlebars.registerHelper("textsaveattributes",function(t){var e,n;return e={dropped:!0,child:t.child||!1,padding:t.padding,containerbackground:t.containerbackground},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),t={startupFocus:!1,title:!1,sharedSpaces:{top:"module-editor__toolbar"},toolbar:[{name:"colors",items:["TextColor","BGColor"]},{name:"styles",items:["Format","Font","FontSize"]},{name:"basic styles",items:["Bold","Italic","Underline","RemoveFormat"]},{name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight"]},{name:"lists",items:["NumberedList","BulletedList"]},{name:"misc",items:["Table","Sglink","HorizontalRule"]}]}}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Alignment=function(){function e(e){this.styleObj=_.extend({},n,e),this.template=Handlebars.compile(t),this.$html=$(),this.value=""}var n;return n={left:!0,center:!0,right:!0},e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$html.find("a").on("click",_.bind(this.onClick,this))},e.prototype.onClick=function(t){var e,n;return t.preventDefault(),e=$(t.currentTarget),n=e.data("alignment"),this.setValue(n),$(this).trigger("update")},e.prototype.setValue=function(t){return this.$html.find(".active").removeClass("active"),this.$html.find("[data-alignment='"+t+"']").addClass("active"),this.value=t},e.prototype.getValue=function(){return this.value},e}(),t='<div class="module-style--attribute module-attribute--alignment">\n  <h5>{{name}}</h5>\n  <div class="module-attribute--alignment__controls">\n    {{#if left}}\n    <a href="#" class="left" data-alignment="left">left</a>\n    {{/if}}\n    {{#if center}}\n    <a href="#" class="center" data-alignment="center">center</a>\n    {{/if}}\n    {{#if right}}\n    <a href="#" class="right" data-alignment="right">right</a>\n    {{/if}}\n  </div>\n  <span class="clearfix"></span>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Checkbox=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.value=""}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$value.on("change",_.bind(this.onChange,this))},e.prototype.onChange=function(){var t;return t=this.$value.is(":checked"),this.value=t,$(this).trigger("update")},e.prototype.setValue=function(t){return t===!0?this.$value.attr("checked","checked"):this.$value.removeAttr("checked"),this.value=t},e.prototype.getValue=function(){return this.value},e}(),t='<div class="module-style--attribute module-attribute--checkbox">\n  <h5>{{name}}</h5>\n  <div class="module-attribute--checkbox__input">\n    <input type="checkbox" role="value">\n  </div>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.ColorPicker=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.$value=$()}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$colorPicker=this.$html.find("[role='color-picker-trigger']"),this.$colorPicker.spectrum({preferredFormat:"hex",showInput:!0,showPalette:!1,showInitial:!0,chooseText:"Save",cancelText:"Cancel",clickoutFiresChange:!1,change:_.bind(this.onColorChange,this),color:"#FFFFFF"}),this.$html.find("[data-role=reset-button]").on("click",_.bind(this.onReset,this)),this.$colorPicker.on("reflow.spectrum",_.bind(this.onSpectrumReflow,this)),this.$colorPicker.on("beforereflow.spectrum",function(){return $(".sp-container").removeClass("reposition-below reposition-above")}),this.$colorPicker.on("dragstop.spectrum",function(t){return function(e,n){return t.onColorChange(n)}}(this)),this.$colorPicker.spectrum("set","#FFFFFF"),this.$value.on("blur",function(t){return function(){var e;return e=$(t.$value).val(),t.$colorPicker.css("backgroundColor",e),t.$colorPicker.spectrum("set",e),t.triggerUpdate()}}(this))},e.prototype.triggerUpdate=function(){return $(this).trigger("update")},e.prototype.onReset=function(t){return t.preventDefault(),this.setValue(this.styleObj.resetValue)},e.prototype.onColorChange=function(t){var e;return e=t.toHexString(),this.setValue(e)},e.prototype.onSpectrumReflow=function(t,e){var n,r;return e.addClass((null!=(n=e.offset())?n.top:void 0)<(null!=(r=$(t.currentTarget).offset())?r.top:void 0)?"reposition-above":"reposition-below")},e.prototype.setValue=function(t,e){return null==t&&(t=""),null==e&&(e=!1),$.trim(t).length&&(this.$colorPicker.css("backgroundColor",t),this.$value.val(t),this.$colorPicker.spectrum("set",t),!e)?this.triggerUpdate():void 0},e.prototype.getValue=function(){return this.$value.val()},e}(),t='<div class="module-style--attribute module-attribute--colorpicker">\n  <h5>{{name}}</h5>\n  <div class="module-attribute--colorpicker__picker">\n    {{#if resetValue}}\n      <a data-role="reset-button" href="#" alt="Reset to default color." title="Reset to default color.">reset</a>\n    {{/if}}\n    <a href="#" class="module-attribute--colorpicker__trigger" role="color-picker-trigger"></a>\n    <div class="module-attribute--input module-attribute--colorpicker__input module-attribute--input__small">\n      <input type="text" role="value" maxlength="7">\n    </div>\n  </div>\n  <div class="cp-default" role="color-picker-container">\n  </div>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.NumberInput=function(){function e(e){this.template=Handlebars.compile(t),this.$html=$(),this.$value=$(),this.styleObj=_.extend({},n,e),this.canBeBlank=this.styleObj.canBeBlank||!1,this.shouldUpdateOnKeyUp=this.styleObj.shouldUpdateOnKeyUp!==!1}var n;return n={inputs:1},e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$value.on({change:_.bind(this.onChange,this),keyup:_.bind(this.onKeyUp,this),blur:this.shouldUpdateOnKeyUp?void 0:_.bind(this.onChange,this)})},e.prototype.onKeyUp=function(t){var e,n,r;return n=t.which,e=$(t.currentTarget),r=parseInt(e.val())||0,38===n?e.val(r+1):40===n&&e.val(this.validate(r-1)?r-1:0),this.shouldUpdateOnKeyUp?$(this).trigger("update"):void 0},e.prototype.onChange=function(t){var e;return e=$(t.currentTarget),this.isMinimumValueMet(e.val())||e.val(this.styleObj.minimumValue),$(this).trigger("update")},e.prototype.isMinimumValueMet=function(t){var e;return parseInt(this.styleObj.minimumValue)?(e=parseInt(t)||0,e>=this.styleObj.minimumValue):!0},e.prototype.setValue=function(t){var e,n,r,i,o,a,l;for(null==t&&(t=""),t=String(t).split(","),e=this.$html.find("input[type='text']"),l=[],n=o=0,a=e.length;a>o;n=++o)i=e[n],null!=t[n]&&(r=t[n]),l.push($(i).val(this.parseInt(r)));return l},e.prototype.getValue=function(){var t;return this.styleObj.inputs<2?this.parseInt(this.$value.val()):(t=_.map(this.$value,function(t){return function(e){return t.parseInt($(e).val())}}(this)),t.join(","))},e.prototype.validate=function(t){return null==t&&(t=null),!_.isNaN(parseInt(t))&&parseInt(t)>0},e.prototype.parseInt=function(t){return this.validate(t)?parseInt(t):this.canBeBlank?"":0},e}(),t='<div class="module-style--attribute module-attribute--numberinput">\n  <h5>{{name}}</h5>\n  {{#times .}}\n    <div class="module-attribute--input module-attribute--numberinput__input module-attribute--input__small">\n      <input type="text" role="value">\n      <span class="module-attribute--numberinput__unit">{{../unit}}</span>\n    </div>\n  {{/times}}\n</div>',Handlebars.registerHelper("times",function(t,e){var n;return n="",_(t.inputs).times(function(){return n+=e.fn(t)}),n})}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Range=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.value=""}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$output=this.$html.find("output"),this.$value.on("input",_.bind(this.onInput,this))},e.prototype.onInput=function(){var t;return t=this.$value.val(),this.value=t,this.$output.text(t),$(this).trigger("update")},e.prototype.setValue=function(t){return this.$value.val(t),this.$output.text(t),this.value=t},e.prototype.getValue=function(){return this.value},e}(),t='<div class="module-style--attribute module-attribute--range">\n  <h5>{{name}}</h5>\n  <form>\n    <input name="range" type="range" role="value" min="{{min}}" max="{{max}}">\n    <div class="module-attribute--range__output">\n      <output for="range"></output>\n      <span>{{unit}}</span>\n    </div>\n  </form>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Select=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.value="",this.options=this.styleObj.options}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$value.select2(),this.$value.on("change",_.bind(this.onChange,this))},e.prototype.onChange=function(){return this.value=this.$value.val(),$(this).trigger("update")},e.prototype.setValue=function(t){return this.$value.select2("val",t),this.value=t},e.prototype.getValue=function(){return this.value},e}(),t='<div class="module-style--attribute module-attribute--select">\n  <h5>{{name}}</h5>\n  <form>\n    <select role="value">\n      {{#options}}\n        <option value="{{value}}">{{name}}</option>\n      {{/options}}\n    </select>\n  </form>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.TextInput=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.$value=$(),this.value=""}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$value=this.$html.find("[role='value']"),this.$value.on("change",_.bind(this.onChange,this))},e.prototype.onChange=function(){var t;return t=this.$value.val(),this.setValue(t),$(this).trigger("update")},e.prototype.setValue=function(t){return this.$value.val(unescape(t))},e.prototype.getValue=function(){return escape(this.$value.val())},e}(),t='<div class="module-style--attribute module-attribute--textinput">\n  <h5>{{name}}</h5>\n  <div class="module-attribute--input module-attribute--textinput__input module-attribute--input__large">\n    <input type="text" role="value">\n  </div>\n</div>'}.call(this),function(){Nlvx.Routers.ContentEditor=function(){function t(){}var e;return t.init=function(t,n,r){var i;return null==n&&(n={}),null==r&&(r={}),i={previewEl:"#content_preview",htmlContentEl:"#html_content",plainTextContentEl:"#plain_text_content"},this.contents=Nlvx.ContentEditor.contentCollection.getContents(),this.router?void 0:this.router=new e($(t),$.extend(i,n),r)},e=function(){function t(t,e,n){this.$el=t,null==e&&(e={}),this.validation=null!=n?n:{},this.previewEl=e.previewEl,this.htmlContentEl=e.htmlContentEl,this.plainTextContentEl=e.plainTextContentEl,this.toggleButton=$(".toggle-slider"),this.toggleButton.on("click",function(t){return function(){return t.toggleSwitchView()}}(this)),this.dndSwitch=new Nlvx.OnOffSwitch($("#dnd-toggle"),$("#editor_mode_warning_modal")),this.setDndSwitch(),$(this.dndSwitch).on({off:function(t){return function(){var e;return null!=(e=t.dragAndDropEditorView)&&e.deactivate(),t.navigationView.showPage("visual-editor"),t.forceVisualEditor()}}(this),on:function(t){return function(){return t.navigationView.showPage("visual-editor"),t.forceVisualEditor(!0)}}(this)}),this.routes={"/":_.bind(this.visualEditor,this),"/visual-editor":_.bind(this.visualEditor,this),"/visual-editor/:version":_.bind(this.visualEditor,this),"/html-editor":_.bind(this.htmlEditor,this),"/html-editor/:version":_.bind(this.htmlEditor,this),"/drag-and-drop-editor":_.bind(this.dragAndDropEditor,this),"/plain-text-editor":_.bind(this.plainTextEditor,this),"/desktop-preview":_.bind(this.desktopPreview,this),"/mobile-preview":_.bind(this.mobilePreview,this)},this.router=Router(this.routes),this.router.configure({before:_.bind(this.beforeRouteTo,this),after:_.bind(this.beforeLeavingRoute,this),async:!0}),this.router.init(),this.instantiateEditView(),window.location.hash.length||this.router.setRoute("visual-editor"),Nlvx.ContentEditor.History.init(),Nlvx.ContentEditor.History.onRewind(function(t){return function(){return t.routeIsVisual()&&Nlvx.ContentEditor.contentCollection.canRewindHTML()?(Nlvx.ContentEditor.contentCollection.rewindHTML(),t.getVisualEditorView().updateContent()):void 0}}(this)),Nlvx.ContentEditor.History.onForward(function(t){return function(){return t.routeIsVisual()&&Nlvx.ContentEditor.contentCollection.canForwardHTML()?(Nlvx.ContentEditor.contentCollection.forwardHTML(),t.getVisualEditorView().updateContent()):void 0
}}(this))}return t.prototype.createModeToggleModal=function(t,e){return this.modal=new Nlvx.HtmlModeToggleModal($(".code-mode"),$("#html_mode_warning_modal"),$("#continue_mode_switch"),$("#stay_in_current_mode"),function(){return function(){return"function"==typeof t?t():void 0}}(this),function(){return function(){return"function"==typeof e?e():void 0}}(this))},t.prototype.setDndSwitch=function(){return this.dndSwitch.set(Nlvx.ContentEditor.contentCollection.isDNDTemplate()?!0:!1)},t.prototype.beforeRouteTo=function(){var t,e;return t=_.last(arguments),e=this.router.getRoute(0)||"",this.router.currentHash=e,this.router.currentVersion=this.router.getRoute(1),this.router.currentVersion&&Nlvx.ContentEditor.contentCollection.setVersion(this.router.currentVersion),null==this.navigationView&&(this.navigationView=new Nlvx.ContentEditor.NavigationView(this.$el)),this.navigationView.showPage(e),t()},t.prototype.routeIsVisual=function(){return"visual-editor"===this.router.currentHash||""},t.prototype.routeIsPlaintext=function(){return"plain-text-editor"===this.router.currentHash},t.prototype.routeIsHtml=function(){return"html-editor"===this.router.currentHash},t.prototype.beforeLeavingRoute=function(){var t,e,n,r;return e=_.last(arguments),n=this.router.getRoute(0)||"","html-editor"===n&&Nlvx.ContentEditor.contentCollection.isDNDTemplate()?(this.createModeToggleModal(function(t){return function(){var n;return t.routeIsVisual()?(n=t.getVisualEditorView(),n.teardown()):t.routeIsHtml()?t.htmlEditorView.teardown():t.routeIsPlaintext()&&t.plainTextEditorView.teardown(),e()}}(this),function(t){return function(){return t.router.setRoute(t.router.currentHash||"")}}(this)),this.modal.show()):(null!=(r=this.modal)&&r.destroy(),this.modal=null,this.routeIsVisual()?(t=this.getVisualEditorView(),t.teardown()):this.routeIsHtml()?this.htmlEditorView.teardown():this.routeIsPlaintext()&&this.plainTextEditorView.teardown(),e())},t.prototype.dragAndDropEditor=function(){return null==this.dragAndDropEditorView&&(this.dragAndDropEditorView=new Nlvx.ContentEditor.DragAndDropEditorView(this.$el,this.validation)),this.dragAndDropEditorView.render()},t.prototype.forceVisualEditor=function(t){var e;return null==t&&(t=!1),this.setDndSwitch(),e=this.getVisualEditorView(t),e.render(),Nlvx.ContentEditor.contentCollection.resetHistory()},t.prototype.visualEditor=function(){var t;return this.setDndSwitch(),t=this.getVisualEditorView(),t.render(),Nlvx.ContentEditor.contentCollection.resetHistory()},t.prototype.getVisualEditorView=function(t){return null==t&&(t=!1),(t===!0||Nlvx.ContentEditor.contentCollection.isDNDTemplate())&&Nlvx.flags.dragAndDrop?null!=this.dragAndDropEditorView?this.dragAndDropEditorView:this.dragAndDropEditorView=new Nlvx.ContentEditor.DragAndDropEditorView(this.$el,this.validation):null!=this.visualEditorView?this.visualEditorView:this.visualEditorView=new Nlvx.ContentEditor.VisualEditorView(this.$el,this.validation)},t.prototype.htmlEditor=function(){return $(document).ready(function(){return window.analytics.track("code_editor",{origin_editor:Nlvx.ContentEditor.contentCollection.isDNDTemplate()?"dd":"advanced"})}),null==this.htmlEditorView&&(this.htmlEditorView=new Nlvx.ContentEditor.HtmlEditorView(this.$el,this.validation)),this.htmlEditorView.render()},t.prototype.plainTextEditor=function(){return null==this.plainTextEditorView&&(this.plainTextEditorView=new Nlvx.ContentEditor.PlainTextEditorView(this.$el,this.validation)),this.plainTextEditorView.render()},t.prototype.desktopPreview=function(){return this.renderPreview(!1)},t.prototype.mobilePreview=function(){return this.renderPreview(!0)},t.prototype.renderPreview=function(t){return null==this.desktopPreviewView&&(this.desktopPreviewView=new Nlvx.ContentEditor.PreviewView(this.$el,this.previewEl)),this.desktopPreviewView.render(t)},t.prototype.instantiateEditView=function(){return this.editView?void 0:(this.editView=new Nlvx.ContentEditor.EditView(this.$el,this.htmlContentEl,this.plainTextContentEl),this.editView.bindEvents())},t.prototype.reRecordFormData=function(){return this.editView.reRecordFormData()},t.prototype.toggleSwitchView=function(){var t,e;return t=this.router.getRoute(1)||"",e=""===t?""+t:"/"+t,this.router.setRoute(this.routeIsVisual()?"html-editor"+e:"visual-editor"+e)},t.prototype.switchToVersion=function(t){return null==t&&(t="a"),this.routeIsHtml()?(this.router.setRoute("html-editor/"+t),this.htmlEditor()):(this.router.setRoute("visual-editor/"+t),this.visualEditor())},t}(),t}()}.call(this),function(){Nlvx.ConversionWarningModal=function(){function t(t,e){this.$target=$(t),this.modal=this.$target.find(e)}return t.prototype.render=function(t,e){var n,r,i;return r=this.modal.modal({show:!0,backdrop:!1}),n=r.find(".modal-content").width(),i=0>=t-n?t:t-n,r.css({top:e,left:i,right:"initial"})},t}()}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Button=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$()}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(t){return this.$html.on("click",_.bind(this.onClick,this,t))},e.prototype.onClick=function(t,e){return e.preventDefault(),this.styleObj.callback(t)},e.prototype.setValue=function(){return void 0},e.prototype.getValue=function(){return void 0},e}(),t='<div class="module-style--attribute module-attribute--button">\n  {{#label}}<h5>{{.}}</h5>{{/label}}\n  <a href="#" class="{{cssClasses}}" title="{{altText}}">{{name}}</a>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.CheckboxInput=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$(),this.$checkboxValue=$(),this.$textinputValue=$()}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){return this.$checkboxValue=this.$html.find("[type='checkbox'][role='value']"),this.$textinputValue=this.$html.find("[type='text'][role='value']"),this.$checkboxValue.on("change",_.bind(this.onChange,this)),this.$textinputValue.on("change",_.bind(this.onChange,this))},e.prototype.onChange=function(){return this.value={checked:this.$checkboxValue.is(":checked"),text:this.$textinputValue.val()},this.setValue(this.value),$(this).trigger("update")},e.prototype.setValue=function(t){return this.$checkboxValue.prop("checked",t.checked),this.$textinputValue.val(unescape(t.text))},e.prototype.getValue=function(){return this.value},e}(),t='<div class="module-style--attribute module-attribute--checkboxinput">\n  <div class="row">\n    <div class="col-md-3">\n      <h5>{{name}}</h5>\n    </div>\n    <div class="col-md-2">\n      <div class="module-attribute--checkbox__input">\n        <input type="checkbox" role="value" />\n      </div>\n    </div>\n    <div class="col-md-7">\n      <div class="module-attribute--input module-attribute--textinput__input module-attribute--input__large">\n        <input type="text" role="value" placeholder="{{placeholder}}"/>\n      </div>\n    </div>\n  </div>\n</div>'}.call(this),function(){var t,e;null==(e=Nlvx.DragAndDropEditor).attributes&&(e.attributes={}),Nlvx.DragAndDropEditor.attributes.Divider=function(){function e(e){this.styleObj=e,this.template=Handlebars.compile(t),this.$html=$()}return e.prototype.build=function(){return this.$html=$(this.template(this.styleObj))},e.prototype.afterBuild=function(){},e.prototype.setValue=function(){},e.prototype.getValue=function(){return""},e}(),t='<div class="module-style--attribute module-attribute--divider"></div>'}.call(this),function(){var t,e,n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.divider=function(n){function i(n,r){this.innerHTML=null!=n?n:"",this.attributes=null!=r?r:{},i.__super__.constructor.call(this,this.innerHTML,this.attributes),this.attributes=_.extend({},o,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return r(i,n),a=[{name:"Background Color",type:"ColorPicker",attributeName:"containerbackground"},{name:"Line Color",type:"ColorPicker",attributeName:"linecolor"},{name:"Height",type:"NumberInput",unit:"PX",attributeName:"height"},{name:"Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"padding"}],o={containerbackground:"#ffffff",linecolor:"#000000",padding:"0,0,0,0",height:5},i.prototype.displayName="Divider",i.prototype.build=function(){return this.$html=$(this.designTemplate({attributes:this.attributes}))},i.prototype.afterBuild=function(){return this.$html.on("click",function(t){return function(){return $(t.$html).hasClass("style-group-selected")?void 0:$(t).trigger("select")}}(this)),i.__super__.afterBuild.apply(this,arguments)},i.prototype.getHTML=function(){return this.codeTemplate({attributes:this.attributes})},i.prototype.getStyles=function(){return a},i.prototype.getType=function(){return"divider"},i}(Nlvx.DragAndDropEditor.Module),e='<table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" class="module" role="module" data-type="divider">\n  <tr><td style="{{dividerpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n    <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" height="{{attributes.height}}"  style="font-size: {{attributes.height}}px; line-height: {{attributes.height}}px;">\n      <tr><td bgcolor="{{attributes.linecolor}}">&nbsp;</td></tr>\n    </table>\n    <div class="module-controls" role="module-controls">\n      <span class="module-controls__move"></span>\n      <span class="module-controls__delete" role="module-delete"></span>\n      <span class="module-controls__duplicate" role="module-duplicate"></span>\n    </div>\n  </td></tr>\n</table>',t='<table class="module" role="module" data-type="divider" border="0" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" data-attributes=\'{{{divideraveattributes attributes}}}\'>\n<tr><td role="module-content" style="{{dividerpadding attributes}}" bgcolor="{{attributes.containerbackground}}">\n  <table border="0" cellpadding="0" cellspacing="0" align="center" width="100%" height="{{attributes.height}}"  style="font-size: {{attributes.height}}px; line-height: {{attributes.height}}px;">\n    <tr><td bgcolor="{{attributes.linecolor}}">&nbsp;</td></tr>\n  </table>\n</td></tr></table>\n',Handlebars.registerHelper("divideraveattributes",function(t){var e,n;return e={dropped:!0,padding:t.padding,containerbackground:t.containerbackground,linecolor:t.linecolor,height:t.height},n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("dividerpadding",function(t){var e;return e=t.padding,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")})}.call(this),function(){var t,e,n,r={}.hasOwnProperty,i=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Nlvx.DragAndDropEditor.modules.social=function(n){function r(n,i){this.innerHTML=null!=n?n:"",null==i&&(i={}),this.attributes=$.extend(!0,{},o,i),r.__super__.constructor.call(this,this.innerHTML,this.attributes),this.designTemplate=Handlebars.compile(e),this.codeTemplate=Handlebars.compile(t)}var o,a;return i(r,n),a=[{name:"Background Color",type:"ColorPicker",attributeName:"backgroundcolor"},{name:"Icon Color",type:"ColorPicker",attributeName:"iconcolor",resetValue:"AUTO"},{name:"Icon Size",type:"Range",attributeName:"iconsize",min:30,max:60,unit:"px"},{name:"Border Radius",type:"Range",attributeName:"borderradius",min:0,max:30,unit:"px"},{name:"Padding",type:"NumberInput",unit:"PX",inputs:4,attributeName:"padding"},{name:"Alignment",type:"Alignment",attributeName:"alignment"},{name:"Facebook",type:"CheckboxInput",placeholder:"Facebook Link",attributeName:"option_facebook"},{name:"Twitter",type:"CheckboxInput",placeholder:"Twitter Link",attributeName:"option_twitter"},{name:"Instagram",type:"CheckboxInput",placeholder:"Instagram Link",attributeName:"option_instagram"},{name:"Google+",type:"CheckboxInput",placeholder:"Google+ Link",attributeName:"option_googleplus"},{name:"Pinterest",type:"CheckboxInput",placeholder:"Pinterest Link",attributeName:"option_pinterest"},{name:"LinkedIn",type:"CheckboxInput",placeholder:"LinkedIn Link",attributeName:"option_linkedin"}],o={backgroundcolor:"#FFFFFF",iconcolor:"AUTO",iconsize:30,borderradius:2,padding:"0,0,0,0",alignment:"center",imageurl:{white:"https://marketing-image-production.s3.amazonaws.com/social/white/"},option_facebook:{checked:!0,text:"",filename:"facebook.png",title:"Facebook",backgroundcolor:"#3B579D"},option_twitter:{checked:!0,text:"",filename:"twitter.png",title:"Twitter",backgroundcolor:"#7AC4F7"},option_instagram:{checked:!0,text:"",filename:"instagram.png",title:"Instagram",backgroundcolor:"#7F4B30"},option_googleplus:{checked:!0,text:"",filename:"google-plus.png",title:"Google+",backgroundcolor:"#D44132"},option_pinterest:{checked:!0,text:"",filename:"pinterest.png",title:"Pinterest",backgroundcolor:"#CB2027"},option_linkedin:{checked:!0,text:"",filename:"linkedin.png",backgroundcolor:"#0077B5"}},r.prototype.displayName="Social",r.prototype.build=function(){return r.__super__.build.apply(this,arguments),this.$html=$(this.designTemplate({attributes:this.attributes}))},r.prototype.afterBuild=function(){return r.__super__.afterBuild.apply(this,arguments),this.$html.on("click",function(t){return function(){return $(t.$html).hasClass("style-group-selected")?void 0:$(t).trigger("select")}}(this)),this.$html.find("a").on("click",function(t){return t.preventDefault()})},r.prototype.getHTML=function(){return this.codeTemplate({attributes:this.attributes})},r.prototype.teardown=function(){return r.__super__.teardown.apply(this,arguments),this.$html.off("click"),this.$html.find("a").off("click")},r.prototype.updateHTML=function(){return this.rerender(),$(this).trigger("change")},r.prototype.updateAttributes=function(t){return null==t&&(t={}),$.extend(!0,this.attributes,t),this.updateHTML()},r.prototype.getStyles=function(){return a},r.prototype.getType=function(){return"social"},r}(Nlvx.DragAndDropEditor.Module),n=function(t,e){var n,r,i,o;return null==e&&(e=!1),i="",r=["-webkit","-moz","-ms","-o"],o=_.filter(Object.keys(t),function(t){return t.indexOf("option_")>-1}),n=t.imageurl.white,_.each(o,function(o){var a,l,s,u,d,c,p;return l=t[o].backgroundcolor,"AUTO"!==t.iconcolor&&(l=t.iconcolor),a="background-color: "+l+";",s="border-radius: "+t.borderradius+"px; "+_.map(r,function(e){return""+e+"-border-radius:"+t.borderradius+"px;"}).join(" "),c="height: "+t.iconsize+"px; width: "+t.iconsize+"px;",t[o].checked&&t[o].text.length||t[o].checked&&!t[o].text.length&&!e?(p=t[o].title,t[o].text.length||(p+=" [Missing Link]"),d='<td style="padding: 0px 5px;"><a\nrole="social-icon-link"\nhref="'+unescape(t[o].text)+'"\ntarget="_blank"\nborder="0"\nalt="'+t[o].title+'"\ntitle="'+p+'"\nstyle="'+a+" "+s+' color: white; display: inline-block; outline: none; text-decoration:none; border: none; font-family: Helvetica, arial, sans-serif;">',u="</a></td>",i+=new Handlebars.SafeString(""+d+'\n  <img\n    role="social-icon"\n    alt="'+t[o].title+'"\n    title="'+p+'"\n    border="0"\n    height="'+t.iconsize+'"\n    width="'+t.iconsize+'"\n    style="'+c+' border:none; color: white; font-family: Helvetica, arial, sans-serif;"\n    src="'+(n+t[o].filename)+'"\n  />\n'+u)):void 0}),i},Handlebars.registerHelper("socialicons",function(t){return n(t)}),Handlebars.registerHelper("socialiconscodeview",function(t){return n(t,!0)}),Handlebars.registerHelper("socialsaveattributes",function(t){var e,n,r,i;return r=_.filter(Object.keys(t),function(t){return t.indexOf("option_")>-1}),e={backgroundcolor:t.backgroundcolor,iconsize:t.iconsize,iconcolor:t.iconcolor,borderradius:t.borderradius,padding:t.padding,alignment:t.alignment},i=_.pick(t,r),e=_.extend({},e,i),n=escape(JSON.stringify(e)),new Handlebars.SafeString(n)}),Handlebars.registerHelper("padding",function(t){var e;return e=t.padding,0!==e&&(e=e.split(",").join("px ")),new Handlebars.SafeString("padding: "+e+"px;")}),e='<table role="module" data-type="social" border="0" cellpadding="0" cellspacing="0" width="100%" class="wrapper module">\n  <tr>\n    <td align="{{attributes.alignment}}" valign="top" style="background-color:{{attributes.backgroundcolor}}; {{padding attributes}}">\n      <div class="module-content"><table cellpadding="0" cellspacing="0" border="0" style="" align="{{attributes.alignment}}">\n        <tr>\n          {{{socialicons attributes}}}\n        </tr>\n      </table></div>\n      <div class="module-controls">\n        <span class="module-controls__move"></span>\n        <span class="module-controls__delete" role="module-delete"></span>\n        <span class="module-controls__duplicate" role="module-duplicate"></span>\n      </div>\n    </td>\n  </tr>\n</table>',t='<table role="module" data-type="social" border="0" align="center" cellpadding="0" cellspacing="0" width="100%" style="table-layout: fixed;" class="wrapper" data-attributes=\'{{socialsaveattributes attributes}}\'>\n<tr>\n  <td style="font-size:6px;line-height:10px;background-color:{{attributes.imagebackground}};{{padding attributes}}" valign="top" align="{{attributes.alignment}}" role="module-content">\n      <table cellpadding="0" cellspacing="0" border="0" style="" align="{{attributes.alignment}}">\n        <tr>{{{socialiconscodeview attributes}}}</tr>\n      </table>\n  </td>\n</tr>\n</table>'}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.ContentEditor.DragAndDropEditorView=function(n){function i(t,n){this.validation=null!=n?n:{},this.validateContent=e(this.validateContent,this),this.onDeleteKeydownHandler=e(this.onDeleteKeydownHandler,this),this.$target=$(t),this.editor=new Nlvx.DragAndDropEditor,$(this.editor).on("change",_.bind(this.handleEditorChange,this)),this.validation.validator&&(this.$contentNotice=$("#dnd_content_notice"),this.$contentNotice.errorNotice({message:this.validation.message,validator:this.validateContent,noticeEl:this.$contentNotice}))}return r(i,n),i.prototype.render=function(){return this.setupABTabs(),Nlvx.ContentEditor.ScreenBehaviors.overrideDeleteKey(!0,this.onDeleteKeydownHandler),this.appear(),this.editor.redraw(),this.handleEditorChange()},i.prototype.setupABTabs=function(){var t,e;return e=Nlvx.ContentEditor.contentCollection.getVersion(),$("ul.contentabtest--tabs").remove(),Nlvx.ContentEditor.contentCollection.hasMultiple()?(t=Nlvx.ContentEditor.contentCollection.getVersions(),this.$tabs=$(this.buildTabs({tabs:t,size:t.length})),$("#drag_and_drop_editor").before(this.$tabs),this.$tabs.find("li.active").removeClass("active"),this.$tabs.find("li[data-version='"+e+"']").addClass("active")):void 0},i.prototype.updateContent=function(){return this.editor.redraw()},i.prototype.onDeleteKeydownHandler=function(t){return this.isInputFocused()?!0:(this.editor.removeSelectedModules(),t.preventDefault(),!1)},i.prototype.buildTabs=function(e){var n;return(n=Handlebars.compile(t))(e)},i.prototype.appear=function(){return this.$target.find(".template-editors, #drag_and_drop_editor").show(),this.$target.find(".toggle-slider .select").removeClass("right").addClass("left"),$("body").addClass("with-style-tab"),$(".drag-modules").show(),$("#email-preheader-setting").show(),$("#dnd-toggle-group").show()},i.prototype.teardown=function(){return $("#email-preheader-setting").hide(),$("#dnd-toggle-group").hide(),$("body").removeClass("with-style-tab"),this.handleEditorChange(),this.editor.teardownModules(),Nlvx.ContentEditor.ScreenBehaviors.overrideDeleteKey(!1)},i.prototype.handleEditorChange=function(){var t,e,n;return(null!=(e=this.editor.getAllModules())?e.length:void 0)?(t=this.editor.getModulesHTML(),Nlvx.ContentEditor.contentCollection.setHTML(t),null!=(n=this.$contentNotice)&&n.errorNotice("check"),this.$target.trigger("contentChange")):void 0},i.prototype.deactivate=function(){return this.editor.deactivate(),this.teardown()},i.prototype.validateContent=function(){return this.validation.validator?this.validation.validator(Nlvx.Sanitizers.removeJavascript(this.editor.getModulesHTML())):!0},i}(Nlvx.ContentEditor.EditorViewBase),t='<ul class="contentabtest--tabs contentabtest--tabs__{{size}}">\n  {{#tabs}}\n    <li data-version="{{.}}"><a href="#visual-editor/{{.}}">{{.}}</a></li>\n  {{/tabs}}\n</ul>'}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Nlvx.ContentEditor.EditView=function(){function e(e,n,r){this.htmlContentEl=n,this.plainTextContentEL=r,this.submitSendTestForm=t(this.submitSendTestForm,this),this.submitSaveForm=t(this.submitSaveForm,this),this.submitSendForm=t(this.submitSendForm,this),this.displayErrorMessages=t(this.displayErrorMessages,this),this.validateAndPerform=t(this.validateAndPerform,this),this.reRecordFormData=t(this.reRecordFormData,this),this.disableSaveSend=t(this.disableSaveSend,this),this.enableSaveSend=t(this.enableSaveSend,this),this.$target=$(e),this.redirect_url=null,this.allowAutoSave=!1,this.skipSaveFlash=!1,this.editor_form="#"+this.$target.find("form.edit_content").attr("id"),this.formData=this.getFormData(!1),Nlvx.ContentEditor.autoConvertToPlain=!0,this.sendOrSave=function(){},this.$target.find("form.auto_save").length&&(setInterval(_.bind(this.autoSaveIfEnabled,this),12e4),this.enableSaveSend())}return e.prototype.plaintextIsLocked=function(){return"1"===this.$target.find("#campaign_has_plain_text_lock").val()},e.prototype.bindEvents=function(){return this.$target.on("keypress",".campaign-form",function(t){return 13!==t.which||$(t.target).is("textarea")?void 0:t.preventDefault()}),this.$target.on("click","#exit_modal",function(t){return function(){return t.enableSaveSend()}}(this)),this.$target.on("click",".save-content",function(t){return function(e){return t.saveCampaign(e)}}(this)),this.$target.on("click","#htmlplain_modal .confirm",function(t){return function(){return t.submitSaveForm()}}(this)),this.$target.on("click","#sendOrSave_conversion_warning_modal .confirm",function(t){return function(){return t.copyContentToFormAndSubmit()}}(this)),this.$target.on("click","#sendOrSave_ignore_import_html_warning",function(t){return function(){return t.ignorePlainContentAndSubmit()}}(this)),this.$target.on("click","#send_campaign",function(t){return function(e){return t.sendCampaign(e)}}(this)),this.$target.on("click","#send_test_campaign",function(t){return function(e){return t.sendTestCampaign(e)}}(this)),this.$target.on("click","#back-button",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.checkForm()}}(this)),this.$target.on("click","#exit_warning_modal .confirm",function(){return function(){return Nlvx.WindowHandler.redirect($("#back-button").attr("href"))}}(this)),this.$target.on("click","#exit_modal",function(t){return function(){return t.sendOrSave=function(){}}}(this))},e.prototype.enableSaveSend=function(){return this.allowAutoSave=!0,$("#send_campaign").add(".save-content").removeClass("disabled")},e.prototype.disableSaveSend=function(){return this.allowAutoSave=!1,$("#send_campaign").add(".save-content").addClass("disabled")},e.prototype.reRecordFormData=function(){return this.formData=this.getFormData(!1)},e.prototype.checkForm=function(){var t,e;return e=this.formData,t=this.getFormData(!1),e!==t?$("#exit_warning_modal").modal({show:!0,backdrop:!1}):Nlvx.WindowHandler.redirect($("#back-button").attr("href"))},e.prototype.getFormData=function(t){var e,n,r;return t?$("select, input",$(this.editor_form)).serialize():(e=Nlvx.ContentEditor.contentCollection.getContents(),n=_.map(e,function(t){return t.getHTML()}),r=_.map(e,function(t){return t.getPlaintext()}),$("select, input[name!=authenticity_token]",$(this.editor_form)).serialize()+n.join("").replace(/\s/g,"")+r.join("").replace(/\s/g,""))},e.prototype.saveCampaign=function(t){return this.redirect_url=$(t.target).data("url"),this.validateAndPerform(this.submitSaveForm,t),!1},e.prototype.sendCampaign=function(t){return this.validateAndPerform(this.submitSendForm,t),!1},e.prototype.sendTestCampaign=function(t){var e;return this.skipSaveFlash=!0,e=this.validateAndPerform(this.submitSaveForm,t),e.done(function(e){return function(){return e.validateAndPerform(e.submitSendTestForm,t)}}(this)),e.always(function(t){return function(){return t.skipSaveFlash=!1}}(this)),!1},e.prototype.validateAndPerform=function(t,e){return this.copyContentToForm(),this.extractListsAndSegmentsFromQueries(),this.plaintextIsLocked()?(this.sendOrSave=t,this.ignorePlainContentAndSubmit()):Nlvx.ContentEditor.autoConvertToPlain?(this.sendOrSave=t,this.copyContentToFormAndSubmit()):Nlvx.ContentEditor.contentCollection.hasContentsThatDontMatch()?(this.sendOrSave=t,this.showConversionWarningModal(e)):t()},e.prototype.displayErrorMessages=function(t){var e;return e=_.reduce(t,function(t,e,n){return t+(""+(n+1)+". "+e+" <br/>")},""),Nlvx.FlashMessageHandler.add("danger",e)},e.prototype.submitSendForm=function(){var t,e;return $(".disabling-div").show(),e=this.$target.find("form.edit_content"),this.disableSaveSend(),t=$.ajax({url:e.attr("action"),method:"PUT",dataType:"json",data:$.param(e.serializeArray().concat({name:"validate_for_send",value:!0}))}),t.done(function(t){return function(){return t.$target.off("click","#send_campaign"),t.$target.find("#send_campaign").click()}}(this)),t.fail(function(t){return function(e){switch($(".disabling-div").hide(),t.enableSaveSend(),e.status){case 400:return t.displayErrorMessages(e.responseJSON.errors);case 403:return t.displayErrorMessages(e.responseJSON.errors),setTimeout(function(){return Nlvx.WindowHandler.redirect(e.responseJSON.redirect)},3e3);default:return Nlvx.FlashMessageHandler.add("danger","An Error has occurred")}}}(this)),t.always(function(t){return function(){return t.enableSaveSend()}}(this))},e.prototype.submitSaveForm=function(){var t,e,n,r;return $(".disabling-div").show(),t=this.$target.find("form.edit_content"),n=t.attr("action"),r=this.getFormData(!0),this.disableSaveSend(),e=$.ajax({headers:{"X-Auto-Save":!1},url:n+".json",type:"POST",datatype:"json",data:r}),e.done(function(t){return function(e){var n;return t.formData=t.getFormData(!1),n=e.redirect_url||t.redirect_url,n?Nlvx.WindowHandler.redirect(n):($(".disabling-div").hide(),t.skipSaveFlash!==!0?Nlvx.FlashMessageHandler.add("success",e.flash_msg):void 0)}}(this)),e.fail(function(t){return function(e){switch($(".disabling-div").hide(),e.status){case 400:return t.displayErrorMessages(e.responseJSON.errors);case 401:return Nlvx.FlashMessageHandler.add("danger","Your session has expired. As a precaution we recommend you back up any changes before reloading or navigating away from this page.");case 403:return t.displayErrorMessages(e.responseJSON.errors),setTimeout(function(){return Nlvx.WindowHandler.redirect(e.responseJSON.redirect)},3e3);default:return Nlvx.FlashMessageHandler.add("danger","Failed to save changes.")}}}(this)),e.always(function(t){return function(){return t.enableSaveSend()}}(this))},e.prototype.submitSendTestForm=function(){var t,e;return this.disableSaveSend(),t=_.reject($("#campaign-testing input[name='test_to_addresses']").val().split(/[,; ]/),function(t){return""===t}),e=$.ajax({url:$("#send_test_campaign").data("path"),type:"POST",headers:{"X-CSRF-Token":$("meta[name=csrf-token]").attr("content")},data:{to:t}}),e.done(function(){return function(){return Nlvx.FlashMessageHandler.add("success","Your test email has been sent."),window.analytics.track("test_email",{recipients_count:t.length,source:"ui"})}}(this)),e.fail(function(){return function(t){var e,n,r;return null!=(null!=t&&null!=(r=t.responseJSON)?r.errors:void 0)&&(e=_.map(t.responseJSON.errors,function(t){return t.message})),(null!=e?e.length:void 0)?(n=e.join(" "),Nlvx.FlashMessageHandler.add("danger",n)):void 0}}(this)),e.always(function(t){return function(){return t.enableSaveSend()}}(this))},e.prototype.showConversionWarningModal=function(t){return new Nlvx.ConversionWarningModal(this.$target,"#sendOrSave_conversion_warning_modal").render(t.pageX,t.pageY)},e.prototype.copyContentToFormAndSubmit=function(){return Nlvx.ContentEditor.contentCollection.copyHTMLToPlain(),this.copyContentToForm(),this.sendOrSave()},e.prototype.ignorePlainContentAndSubmit=function(){return this.copyContentToForm(),this.sendOrSave()},e.prototype.copyContentToForm=function(){var t;return t=Nlvx.ContentEditor.contentCollection.getContents(),$('[name*="campaign[campaign_content][content_"]').val(null),$('[name*="campaign[campaign_content][plain_content_"]').val(null),_.each(t,function(t){return function(e,n){var r,i,o;return o="a"===n?"":"_"+n,i=e.getPlaintext(),r=e.getUnescapedHTML(),t.$target.find(""+t.htmlContentEl+o).val(r),t.$target.find(""+t.plainTextContentEL+o).val(i)}}(this))},e.prototype.extractListsAndSegmentsFromQueries=function(){var t;return t={list:[],segment:[]},_.each(this.getQueryIds(),function(e){var n,r,i,o;return r=e.match(/^(\w+)\-(.*)/),o=r[0],n=r[1],i=r[2],t[n].push(i)}),this.setQueryCollectionOfTypeTo("list",t.list),this.setQueryCollectionOfTypeTo("segment",t.segment)},e.prototype.setQueryCollectionOfTypeTo=function(t,e){return this.$target.find("select[name='campaign[campaign_"+t+"_ids][]']").val(e)},e.prototype.getQueryIds=function(){return this.$target.find("#campaign_campaign_query_ids").val()},e.prototype.formatSaveTime=function(t){return $.format.toBrowserTimeZone(t,"E MMM d hh:mm:ss yyyy")},e.prototype.showLastSaveTime=function(){var t;return t=$(".last-saved-at-wrapper"),t.removeClass("fade-out").addClass("visible").one("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",function(t){var e;return e=$(t.currentTarget),e.removeClass("visible").addClass("fade-out")})},e.prototype.autoSaveIfEnabled=function(){return this.allowAutoSave?this.autoSave():void 0},e.prototype.autoSave=function(){var t,e,n,r,i;if(!document.hidden)return $(".btn.save-content").html("Saving..."),this.copyContentToForm(),this.extractListsAndSegmentsFromQueries(),t=$(".last-saved-at-content"),e=this.$target.find("form.auto_save"),r=e.attr("action"),i=$("select, input",e).serialize(),this.disableSaveSend(),n=$.ajax({headers:{"X-Auto-Save":!0},type:"POST",url:r+".json",data:i,dataType:"json"}),n.done(function(e){return function(n){var r;return e.updateABTestID(n.abTestID),e.formData=e.getFormData(!1),null!=n.updatedAt?(r=e.formatSaveTime(n.updatedAt),t.text("All changes saved."),t.attr("data-original-title","Last saved "+r)):void 0}}(this)),n.fail(function(e){return function(n){switch(n.status){case 400:return t.text("Failed to save changes. "+n.responseJSON.errors.join(", "));case 401:return t.text("Failed to save changes."),Nlvx.FlashMessageHandler.add("danger","Your session has expired. As a precaution we recommend you back up any changes before reloading or navigating away from this page.");case 403:return t.text("Failed to save changes."),e.displayErrorMessages(n.responseJSON.errors),setTimeout(function(){return Nlvx.WindowHandler.redirect(n.responseJSON.redirect)},1e4);default:return t.text("Failed to save changes.")}}}(this)),n.always(function(t){return function(){return $(".btn.save-content").html("Save"),t.showLastSaveTime(),t.enableSaveSend()}}(this))},e.prototype.updateABTestID=function(t){var e;return e="",null!=t&&(e=t.toString()),$("input[name='campaign[campaign_ab_test][id]']").val(e)},e}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}};Nlvx.ContentEditor.HtmlEditorView=function(){function n(t,n){this.validation=null!=n?n:{},this.validateContent=e(this.validateContent,this),this.handleHtmlEditorChange=e(this.handleHtmlEditorChange,this),this.$target=$(t),this.validation.validator&&(this.$contentNotice=this.$target.find("#html_content_notice"),this.$contentNotice.errorNotice({message:this.validation.message,validator:this.validateContent,noticeEl:this.$contentNotice}))}return n.prototype.render=function(){return null==this.aceEditor&&(this.aceEditor=this.loadAceEditor()),this.aceEditor.setValue(Nlvx.ContentEditor.contentCollection.getHTML()),this.renderTabs(),this.appear(),this.bindEvents(),this.validateContent()
},n.prototype.bindEvents=function(){return this.aceEditor.on("change",this.handleHtmlEditorChange)},n.prototype.handleHtmlEditorChange=function(){var t;return Nlvx.ContentEditor.contentCollection.setHTML(this.aceEditor.getValue()),null!=(t=this.$contentNotice)&&t.errorNotice("check"),this.$target.trigger("contentChange")},n.prototype.appear=function(){var t;return this.$target.find(".template-editors, .content_editor, .content_html_editor, .content-html-wrapper").show(),this.$target.find(".toggle-slider .select").addClass("right").removeClass("left"),null!=(t=this.$contentNotice)?t.show().errorNotice("check"):void 0},n.prototype.teardown=function(){return this.handleHtmlEditorChange()},n.prototype.loadAceEditor=function(){var t,e;return t=ace.edit($(".content_html_editor")[0]),e=t.getSession(),t.setTheme("ace/theme/tomorrow_night"),e.setMode("ace/mode/html"),e.setUseWrapMode(!0),t},n.prototype.validateContent=function(){return this.aceEditor?this.validation.validator?this.validation.validator(this.aceEditor.getValue()):void 0:!0},n.prototype.buildTabs=function(e){var n;return(n=Handlebars.compile(t))(e)},n.prototype.renderTabs=function(){var t,e;return Nlvx.ContentEditor.contentCollection.hasMultiple()?($("ul.contentabtest--tabs").remove(),t=Nlvx.ContentEditor.contentCollection.getVersions(),this.$tabs=$(this.buildTabs({tabs:t,size:t.length})),$(".content-html-wrapper").prepend(this.$tabs),e=Nlvx.ContentEditor.contentCollection.getVersion(),this.$tabs.find("li.active").removeClass("active"),this.$tabs.find("li[data-version='"+e+"']").addClass("active")):void 0},n}(),t='<ul class="contentabtest--tabs contentabtest--tabs__{{size}}">\n  {{#tabs}}\n    <li data-version="{{.}}"><a href="#html-editor/{{.}}">{{.}}</a></li>\n  {{/tabs}}\n</ul>'}.call(this),function(){Nlvx.ContentEditor.NavigationView=function(){function t(t){this.$target=$(t)}return t.prototype.showPage=function(t){return this.hideAllPages(),this.toggleNavigation(t)},t.prototype.hideAllPages=function(){return this.$target.find("#visual_editor, .template-editors, .content_plain_editor, .content-html-wrapper, .content_html_editor, .content-previews, .content_editor, #visual_content_notice, #html_content_notice, #plain_content_notice, #drag_and_drop_editor").hide()},t.prototype.toggleNavigation=function(t){return this.$target.find(".toggle-preview").removeClass("active"),this.$target.find('[href="#'+t+'"]').addClass("active")},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Nlvx.ContentEditor.PlainTextEditorView=function(){function e(e,n){this.validation=null!=n?n:{},this.validateContent=t(this.validateContent,this),this.handlePlainEditorChange=t(this.handlePlainEditorChange,this),this.$target=$(e),this.acePlainEditor=null,this.validation.validator&&(this.$contentNotice=this.$target.find("#plain_content_notice"),this.$contentNotice.errorNotice({validator:this.validateContent,noticeEl:this.$contentNotice,message:this.validation.message}))}return e.prototype.render=function(){return Nlvx.ContentEditor.autoConvertToPlain=!1,null==this.acePlainEditor&&(this.acePlainEditor=this.loadAceEditor()),this.acePlainEditor.setValue(Nlvx.ContentEditor.contentCollection.getPlaintext()),Nlvx.ContentEditor.contentCollection.contentMatches()||this.showConversionWarningModal(),this.appear(),this.bindEvents(),this.handlePlainEditorChange()},e.prototype.bindEvents=function(){return this.$target.on("click","#import_from_html",function(t){return function(){return t.importFromHtml()}}(this)),this.acePlainEditor.on("change",function(t){return function(){return t.updatePlaintextLock(1),t.handlePlainEditorChange()}}(this))},e.prototype.appear=function(){var t;return this.$target.find(".template-editors, .content_editor, .content_plain_editor").show(),this.$target.find(".contentabtest--tabs").hide(),null!=(t=this.$contentNotice)?t.show().errorNotice("check"):void 0},e.prototype.updatePlaintextLock=function(t){return null==t&&(t=0),this.$target.find("#campaign_has_plain_text_lock").val(t)},e.prototype.handlePlainEditorChange=function(){var t;return Nlvx.ContentEditor.contentCollection.setPlaintext(this.acePlainEditor.getValue()),null!=(t=this.$contentNotice)&&t.errorNotice("check"),this.$target.trigger("contentChange")},e.prototype.loadAceEditor=function(){var t;return t=ace.edit($(".content_plain_editor")[0]),t.setTheme("ace/theme/chrome"),t.setHighlightActiveLine(!1),t.setShowPrintMargin(!1),t.renderer.setShowGutter(!1),t.getSession().setMode("ace/mode/text"),t},e.prototype.showConversionWarningModal=function(){return this.$target.find("#conversion_warning_modal").modal({show:!0,backdrop:!1})},e.prototype.importFromHtml=function(){return Nlvx.ContentEditor.contentCollection.copyHTMLToPlain(),this.acePlainEditor.setValue(Nlvx.ContentEditor.contentCollection.getPlaintext()),this.updatePlaintextLock(0)},e.prototype.validateContent=function(){return this.acePlainEditor?this.validation.validator?this.validation.validator(Nlvx.Sanitizers.removeJavascript(this.acePlainEditor.getValue())):void 0:!0},e.prototype.teardown=function(){return this.handlePlainEditorChange()},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};Nlvx.ContentEditor.PreviewView=function(){function e(e,n){this.previewEl=n,this.replaceSenderIdentityTags=t(this.replaceSenderIdentityTags,this),this.$target=$(e)}return e.prototype.render=function(t){var e;return null==t&&(t=!1),this.appear(t),e=this.$target.find("#campaign_campaign_split_sender_identity_id").val(),e?$.ajax({url:"/marketing_campaigns/senders/"+e+".json",method:"GET"}).done(this.replaceSenderIdentityTags).error(this.updatePreviewContent(Nlvx.ContentEditor.contentCollection.getHTML())):this.updatePreviewContent(Nlvx.ContentEditor.contentCollection.getHTML())},e.prototype.replaceSenderIdentityTags=function(t){var e,n;return n=t.address,t.address_2&&(n=n+", "+t.address_2),e=Nlvx.ContentEditor.contentCollection.getHTML().replace(/\[Sender_Name\]/g,t.from_name).replace(/\[Sender_Address\]/g,n).replace(/\[Sender_City\]/g,t.city).replace(/\[Sender_State\]/g,t.state).replace(/\[Sender_Zip\]/g,t.zip).replace(/\[Sender_Country\]/g,t.country),this.updatePreviewContent(e)},e.prototype.updatePreviewContent=function(t){var e,n;return e=this.$target.find(this.previewEl).get(0),n=e.contentWindow?e.contentWindow:e.contentDocument.document?e.contentDocument.document:e.contentDocument,n.document.open(),n.document.write(Nlvx.Sanitizers.removeJavascript(t)),$(n.document).find("a").attr("href","javascript:void(0)"),n.document.close()},e.prototype.appear=function(t){return this.$target.find(".content-previews").show(),t?(this.$target.find(".desktop-view").addClass("mobile-view").removeClass("desktop-view"),$(".content-previews").parent().addClass("scrollable")):(this.$target.find(".mobile-view").addClass("desktop-view").removeClass("mobile-view"),$(".content-previews").parent().removeClass("scrollable"))},e}()}.call(this),function(){var t,e=function(t,e){return function(){return t.apply(e,arguments)}},n={}.hasOwnProperty,r=function(t,e){function r(){this.constructor=t}for(var i in e)n.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Nlvx.ContentEditor.VisualEditorView=function(n){function i(t,n){this.validation=null!=n?n:{},this.validateContent=e(this.validateContent,this),this.handleEditorChange=e(this.handleEditorChange,this),this.onDeleteKeydownHandler=e(this.onDeleteKeydownHandler,this),this.$target=$(t),this.validation.validator&&(this.$contentNotice=this.$target.find("#visual_content_notice"),this.$contentNotice.errorNotice({message:this.validation.message,validator:this.validateContent,noticeEl:this.$contentNotice}))}return r(i,n),i.prototype.bindEvents=function(){return Nlvx.ContentEditor.ScreenBehaviors.overrideDeleteKey(!0,this.onDeleteKeydownHandler),this.visualEditor.on("change",this.handleEditorChange),this.visualEditor.on("blur",this.handleEditorChange),this.visualEditor.on("instanceReady",function(){return $(".cke_button").each(function(){return $(this).tooltip({container:"#tooltip",delay:{show:0,hide:200}}),$(this).on("show.bs.tooltip",function(){return $("#tooltip").html("")})})}),$(window).on("resize",function(t){return function(){var e;return null!=(null!=(e=t.visualEditor)?e.resize:void 0)?t.visualEditor.resize("100%",$("#visual_editor_wrap").height()):void 0}}(this))},i.prototype.unbindEvents=function(){return Nlvx.ContentEditor.ScreenBehaviors.overrideDeleteKey(!1)},i.prototype.onDeleteKeydownHandler=function(t){return this.isInputFocused()?!0:(t.preventDefault(),!1)},i.prototype.buildTabs=function(e){var n;return(n=Handlebars.compile(t))(e)},i.prototype.render=function(){var t,e;return e=Nlvx.ContentEditor.contentCollection.getVersion(),$("ul.contentabtest--tabs").remove(),Nlvx.ContentEditor.contentCollection.hasMultiple()&&(t=Nlvx.ContentEditor.contentCollection.getVersions(),this.$tabs=$(this.buildTabs({tabs:t,size:t.length})),$("#visual_editor").prepend(this.$tabs),this.$tabs.find("li.active").removeClass("active"),this.$tabs.find("li[data-version='"+e+"']").addClass("active")),this.appear(),this.visualEditor||(this.visualEditor=CKEDITOR.replace("editor_instance",{height:$("#visual_editor_wrap").height()-90,toolbar:[{name:"colors",items:["TextColor","BGColor"]},{name:"styles",items:["Format","Font","FontSize"]},{name:"basicstyles",items:["Bold","Italic","Underline","RemoveFormat"]},{name:"paragraph",items:["JustifyLeft","JustifyCenter","JustifyRight"]},{name:"lists",items:["NumberedList","BulletedList"]},{name:"misc",items:["Table","Imagelibrary","Sglink","HorizontalRule"]}]}),this.bindEvents()),this.visualEditor.setData(Nlvx.ContentEditor.contentCollection.getHTML()),this.handleEditorChange()},i.prototype.updateContent=function(){return this.visualEditor.setData(Nlvx.ContentEditor.contentCollection.getHTML())},i.prototype.teardown=function(t){return this.handleEditorChange(t),this.unbindEvents(),$("#dnd-toggle-group").hide()},i.prototype.appear=function(){var t;return this.$target.find(".template-editors, #visual_editor").show(),this.$target.find(".toggle-slider .select").removeClass("right").addClass("left"),$("body").removeClass("with-style-tab"),$(".drag-modules").hide(),$(".dnd-build-tab").hasClass("active")&&$(".nav-tabs a[href='#campaign-sending']").trigger("click"),null!=(t=this.$contentNotice)&&t.show().errorNotice("check"),$("#dnd-toggle-group").show()},i.prototype.handleEditorChange=function(){var t;return Nlvx.ContentEditor.contentCollection.setHTML(this.visualEditor.getData()),null!=(t=this.$contentNotice)&&t.errorNotice("check"),this.$target.trigger("contentChange")},i.prototype.validateContent=function(){return this.visualEditor?this.validation.validator?this.validation.validator(Nlvx.Sanitizers.removeJavascript(this.visualEditor.getData())):void 0:!0},i}(Nlvx.ContentEditor.EditorViewBase),t='<ul class="contentabtest--tabs contentabtest--tabs__{{size}}">\n  {{#tabs}}\n    <li data-version="{{.}}"><a href="#visual-editor/{{.}}">{{.}}</a></li>\n  {{/tabs}}\n</ul>'}.call(this);